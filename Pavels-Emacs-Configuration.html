<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-02-06 Sat 22:03 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pavel's Emacs Configuration</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Pavel Popov" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" href="//writ.cmcenroe.me/1.0.4/writ.min.css" type="text/css">
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Pavel's Emacs Configuration</h1>
<div class="abstract">
<p>
After trying to use many distributions I finally decided to start mine
from scratch. Many parts of this configuration is copied from
Castlemacs distribution.
</p>

<p>
Literate programming layout is inpired by Protesilaos Stavrou' <a href="https://gitlab.com/protesilaos/dotfiles/-/blob/master/emacs/.emacs.d/">dotfiles</a>.
</p>

</div>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgd071482">1. Reference cards / cheatsheets</a></li>
<li><a href="#orgc09212e">2. Package archives</a></li>
<li><a href="#orga4b4d4c">3. Regenerating Elisp code from Org code</a></li>
<li><a href="#orgd4efb7e">4. Server mode</a></li>
<li><a href="#orgb7ae2b4">5. GUI configuration</a></li>
<li><a href="#org0cd7976">6. Init</a></li>
<li><a href="#org020ce09">7. Working with Buffers</a>
<ul>
<li><a href="#org416a510">7.1. Ibuffer</a></li>
<li><a href="#orgd8edd57">7.2. Bufler</a></li>
<li><a href="#orgf505628">7.3. Minibuffer</a></li>
<li><a href="#org59d2f23">7.4. Navigation in a buffer</a></li>
<li><a href="#org68acfa7">7.5. Unique buffer names</a></li>
</ul>
</li>
<li><a href="#org91dfdf7">8. Custom packages</a>
<ul>
<li><a href="#org7cbfe8f">8.1. <span class="done DONE">DONE</span> Figure out how to download packages from Github url</a></li>
</ul>
</li>
<li><a href="#org28adb1e">9. Getting help, documentation</a>
<ul>
<li><a href="#orgee52951">9.1. Info mode</a></li>
<li><a href="#org5497330">9.2. <span class="done DONE">DONE</span> Integrate DevDocs?</a></li>
</ul>
</li>
<li><a href="#orgfa6dc62">10. Modifier keys</a></li>
<li><a href="#org04c8555">11. Tweaking usage on macOS</a></li>
<li><a href="#org684aa00">12. Sane defaults</a></li>
<li><a href="#org01d55af">13. Recent files</a>
<ul>
<li><a href="#orgbe0d973">13.1. When switching to Emacs a Warning issued "recentf mode: Non-character input-event"</a></li>
<li><a href="#orgb05b05f">13.2. Opening files</a></li>
</ul>
</li>
<li><a href="#org9e27750">14. Working with lists and hash-maps</a></li>
<li><a href="#orgd6734b6">15. Clipboard / Copy / Yank / Paste / Delete</a></li>
<li><a href="#org6372088">16. Calendar</a></li>
<li><a href="#org371dfbe">17. Working with text</a>
<ul>
<li><a href="#org0a82d73">17.1. Google Translate</a></li>
<li><a href="#org1daa411">17.2. Text Editing</a></li>
<li><a href="#org17db7bf">17.3. Join lines</a></li>
<li><a href="#org216e9b7">17.4. Wrap lines on a screen, visual line mode</a></li>
</ul>
</li>
<li><a href="#org9c777cc">18. File management / Dired</a></li>
<li><a href="#orgb046250">19. Undo and redo</a></li>
<li><a href="#org260a981">20. Visuals</a></li>
<li><a href="#org8d7b125">21. Mode line, mode-line, Status Bar</a></li>
<li><a href="#org0ba0b0f">22. Font</a></li>
<li><a href="#orgaa474ae">23. Color themes</a>
<ul>
<li><a href="#org959faa6">23.1. Faff theme changed highlighting of Org headers</a></li>
<li><a href="#org864c8d7">23.2. Switch between dark and light mode in macOS</a></li>
</ul>
</li>
<li><a href="#org257f127">24. Line numbers</a></li>
<li><a href="#orgaccade0">25. Keybindings</a>
<ul>
<li><a href="#org72c6b79">25.1. General, package for setting keybindings</a></li>
<li><a href="#org1f95290">25.2. Commenting/uncommenting</a></li>
</ul>
</li>
<li><a href="#orgd329047">26. Moving around</a>
<ul>
<li><a href="#org922f7c9">26.1. Evil</a></li>
<li><a href="#org3bdbca1">26.2. Xah Fly Keys</a></li>
<li><a href="#org3ab5789">26.3. Moving back</a></li>
</ul>
</li>
<li><a href="#org2871736">27. Window management</a></li>
<li><a href="#orgf95b53b">28. Project management</a></li>
<li><a href="#org5efb517">29. Improving M-x</a></li>
<li><a href="#org8c18e72">30. Selectrum, Marginalia, Consult for completion</a>
<ul>
<li><a href="#orgd53c6dd">30.1. Selectrum</a></li>
<li><a href="#orgb6f78a3">30.2. Prescient - Frecency-based candidate sorting, also offers filtering</a></li>
<li><a href="#org139b3ac">30.3. Marginalia - additional information on completion</a></li>
<li><a href="#org7425c78">30.4. Consult</a></li>
</ul>
</li>
<li><a href="#orged49d93">31. git, version control system, magit</a></li>
<li><a href="#orgda2ed4f">32. Code completion</a></li>
<li><a href="#org359c666">33. Org-mode&#xa0;&#xa0;&#xa0;<span class="tag"><span class="OrgMode">OrgMode</span></span></a>
<ul>
<li><a href="#orgf4c78ec">33.1. Org-babel, Babel, Org Babel&#xa0;&#xa0;&#xa0;<span class="tag"><span class="OrgBabel">OrgBabel</span></span></a></li>
<li><a href="#orgc253e79">33.2. Org-agenda, Ora Agenda&#xa0;&#xa0;&#xa0;<span class="tag"><span class="OrgAgenda">OrgAgenda</span></span></a></li>
<li><a href="#orga69f174">33.3. Org-QL, a query language for Org files&#xa0;&#xa0;&#xa0;<span class="tag"><span class="OrgQL">OrgQL</span></span></a></li>
<li><a href="#orgabc783f">33.4. <span class="done DONE">DONE</span> How to automatically add creation metadata timestamp to Org-mode entry?</a></li>
<li><a href="#orga992f69">33.5. <span class="done DONE">DONE</span> Saving of fh.org (272K) takes significant time</a></li>
</ul>
</li>
<li><a href="#orgc22b8fc">34. Outline-mode - folding and unfolding in Org-mode style</a></li>
<li><a href="#orgd22faf8">35. Eshell</a>
<ul>
<li><a href="#orgb5e7e3a">35.1. How to open a file in emacs?</a></li>
<li><a href="#orge7d5b72">35.2. Setting environment variables</a></li>
</ul>
</li>
<li><a href="#org0025ab3">36. restclient, major mode for sending HTTP requests</a></li>
<li><a href="#orgdfb440b">37. AnyBar, show circle indicator in macOS menu</a></li>
<li><a href="#orgcf36343">38. DeadGrep - Searching in multiple files / project</a>
<ul>
<li><a href="#org1cfe1cd">38.1. Keybindings in Deadgrep buffer</a></li>
</ul>
</li>
<li><a href="#org048bfdd">39. Formatting code</a>
<ul>
<li><a href="#org4dc9389">39.1. Lispy - working with lisp s-expressions</a></li>
<li><a href="#orgaea29c9">39.2. Dealing with pairs - smartparens</a></li>
<li><a href="#orge847e76">39.3. <span class="todo TODO">TODO</span> Setup sql formatting</a></li>
</ul>
</li>
<li><a href="#orgab5547f">40. Colors in compilation buffers</a></li>
<li><a href="#org11e9744">41. Language Server Protocol, LSP</a></li>
<li><a href="#orga93bc15">42. Error checking</a>
<ul>
<li><a href="#org8260b36">42.1. Flymake</a></li>
<li><a href="#org8a71145">42.2. Flycheck</a></li>
</ul>
</li>
<li><a href="#org139c3a9">43. Elisp</a>
<ul>
<li><a href="#orgbf96eb4">43.1. Dash - A modern list api for Emacs</a></li>
<li><a href="#org1c97333">43.2. S - working with strings</a></li>
<li><a href="#org63a5ea7">43.3. HT - working with HashTables</a></li>
<li><a href="#orgdbd04ab">43.4. Example using Elisp</a></li>
</ul>
</li>
<li><a href="#orgd7f599b">44. Golang</a></li>
<li><a href="#org5201b6a">45. Terraform</a></li>
<li><a href="#org8f61056">46. JSON</a>
<ul>
<li><a href="#org57922ee">46.1. Validating if JSON is valid</a></li>
<li><a href="#org04f2199">46.2. <span class="todo TODO">TODO</span> Try json-pointer</a></li>
</ul>
</li>
<li><a href="#org0f57f3e">47. YAML</a></li>
<li><a href="#org25bd77b">48. Ledger, double-entry plain text accounting system</a></li>
<li><a href="#orge3151c5">49. Clojure</a>
<ul>
<li><a href="#orgb0881e1">49.1. How to develop in Clojure (CIDER)</a></li>
<li><a href="#org58f1b52">49.2. inf-clojure</a></li>
<li><a href="#orgba5bf86">49.3. Useful helper functions</a></li>
<li><a href="#orgfa41ef0">49.4. Linter - clj-kondo</a></li>
<li><a href="#org180af72">49.5. ClojureScript</a></li>
<li><a href="#org39ee796">49.6. 4Clojure</a></li>
</ul>
</li>
<li><a href="#org5830ccd">50. JavaScript</a></li>
<li><a href="#org2cb1fe4">51. TypeScript</a></li>
<li><a href="#org9a1088c">52. Scala</a></li>
<li><a href="#org677d1c4">53. Highlighting</a>
<ul>
<li><a href="#orgbd1b829">53.1. Color identifiers mode</a></li>
</ul>
</li>
<li><a href="#orgc27f04a">54. Random helper functions</a></li>
<li><a href="#org2accd5a">55. Network utilities in Emacs</a></li>
<li><a href="#org787d761">56. Open browser from Emacs</a></li>
<li><a href="#orgcd96892">57. Blogging</a>
<ul>
<li><a href="#org9fc9777">57.1. Deft - a package for dealing with text notes</a></li>
<li><a href="#org3c36e34">57.2. Smart Notes / Slip-Box / ZettelKasten</a></li>
</ul>
</li>
<li><a href="#org1dcfa1f">58. Recording video</a></li>
<li><a href="#org2803d7a">59. Jet - transforms between JSON, EDN and Transit&#xa0;&#xa0;&#xa0;<span class="tag"><span class="json">json</span>&#xa0;<span class="edn">edn</span>&#xa0;<span class="clojure">clojure</span>&#xa0;<span class="clj">clj</span></span></a></li>
<li><a href="#org6657956">60. Command log mode - record keystrokes</a></li>
<li><a href="#orgf445209">61. Collaborative editing, Floobits, Live Share</a></li>
<li><a href="#orga9affcb">62. Packages to try someday</a></li>
<li><a href="#orgcff5899">63. Trying packages</a></li>
<li><a href="#org48baf75">64. Reading from s3 using <code>sqlc</code> tool</a></li>
<li><a href="#org9549bfa">65. <span class="todo TODO">TODO</span> Typing response</a></li>
<li><a href="#org1636832">66. Emacs-webkit - using Safari from Emacs</a></li>
<li><a href="#org3122e18">67. <span class="todo TODO">TODO</span> How to explicitly record the mental stack?</a></li>
<li><a href="#org9df38b1">68. Xah Lee's functions</a>
<ul>
<li><a href="#orgfd89cdf">68.1. Opening file in External App</a></li>
</ul>
</li>
<li><a href="#org287ef9f">69. PlantUML for creating diagrams</a>
<ul>
<li><a href="#orgd473b15">69.1. Examples</a></li>
</ul>
</li>
<li><a href="#org94779ba">70. Convert text into Slack's Alphabet Emojis</a></li>
<li><a href="#orgd3099fd">71. Autoremove asked to delete 15 packages that I use</a></li>
<li><a href="#orgea3d8a0">72. Mini frame - display minibuffer at the center of the screen</a></li>
<li><a href="#org2e98813">73. Vega - visualisation grammar</a></li>
<li><a href="#org1d3e66e">74. Prism.el - highlight code by depth</a></li>
<li><a href="#org69dcdc6">75. Emacs NES emulator</a></li>
<li><a href="#org97121d9">76. Working with S3</a></li>
<li><a href="#org29906ec">77. TRAMP</a></li>
<li><a href="#org5a7126f">78. Finda</a></li>
<li><a href="#org8d76ec9">79. Testing how built-in calc works with Babel</a></li>
<li><a href="#orgbe17dd0">80. Toggle function</a></li>
<li><a href="#orgb945e4b">81. Beginend - go to meaningful begin/end of the buffer</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgd071482" class="outline-2">
<h2 id="orgd071482"><span class="section-number-2">1</span> Reference cards / cheatsheets</h2>
<div class="outline-text-2" id="text-1">
<p>
<a href="https://www.gnu.org/software/emacs/refcards/">https://www.gnu.org/software/emacs/refcards/</a>
</p>

<ul class="org-ul">
<li><a href="https://www.gnu.org/software/emacs/refcards/pdf/dired-ref.pdf">Dired cheatsheet</a></li>
<li><a href="https://www.gnu.org/software/emacs/refcards/pdf/refcard.pdf">Emacs cheatsheet</a></li>
<li><a href="https://www.gnu.org/software/emacs/refcards/pdf/survival.pdf">Emacs survival card</a></li>
<li><a href="https://www.gnu.org/software/emacs/refcards/pdf/orgcard.pdf">Org cheatsheet</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgc09212e" class="outline-2">
<h2 id="orgc09212e"><span class="section-number-2">2</span> Package archives</h2>
<div class="outline-text-2" id="text-2">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-12-29 Tue&gt;</span></span>
</p>

<p>
In order for <code>package.el</code> to download packages they should be
specified in repository.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'package-archives
             '("melpa" . "https://melpa.org/packages/"))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga4b4d4c" class="outline-2">
<h2 id="orga4b4d4c"><span class="section-number-2">3</span> Regenerating Elisp code from Org code</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package emacs
  :config
  (defun prot/delete-emacs-init ()
    (interactive)
    (let ((configs "~/.emacs.d/emacs-init.el"))
      (when configs
        (delete-file configs))))
  :hook ((kill-emacs-hook . prot/delete-emacs-init)
       ;;  (kill-emacs-hook . package-quickstart-refresh)
        ))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd4efb7e" class="outline-2">
<h2 id="orgd4efb7e"><span class="section-number-2">4</span> Server mode</h2>
<div class="outline-text-2" id="text-4">
<ul class="org-ul">
<li>Needed to edit commit messages from Eshell when running git commands.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(unless (boundp 'server-process)
  (server-start))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb7ae2b4" class="outline-2">
<h2 id="orgb7ae2b4"><span class="section-number-2">5</span> GUI configuration</h2>
<div class="outline-text-2" id="text-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(tool-bar-mode -1)    ;; Hide tool bar
(scroll-bar-mode -1)  ;; Hide scroll bar
(fringe-mode '(1 . 1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0cd7976" class="outline-2">
<h2 id="org0cd7976"><span class="section-number-2">6</span> Init</h2>
<div class="outline-text-2" id="text-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;; Do run below command from time to time.
;; (package-refresh-contents)

(use-package diminish :ensure t
  :after use-package)

(use-package exec-path-from-shell :ensure t
  :config (when (memq window-system '(mac ns x))
    (exec-path-from-shell-initialize)))

;; adding directories with binaries.
;;(setq exec-path (append exec-path '("/Users/pavel/go/bin"
;;                                    "/usr/local/bin"
;;                                    "/Users/pavel/.pyenv/shims")))
</pre>
</div>
</div>
</div>

<div id="outline-container-org020ce09" class="outline-2">
<h2 id="org020ce09"><span class="section-number-2">7</span> Working with Buffers</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org416a510" class="outline-3">
<h3 id="org416a510"><span class="section-number-3">7.1</span> Ibuffer</h3>
<div class="outline-text-3" id="text-7-1">
</div>
<div id="outline-container-orgd91b75d" class="outline-4">
<h4 id="orgd91b75d"><span class="section-number-4">7.1.1</span> <span class="todo TODO">TODO</span> Stop confirmation when killing non-edited buffers</h4>
<div class="outline-text-4" id="text-7-1-1">
<p>
@Prot showed example in one of his videos.
</p>
</div>
</div>
</div>
<div id="outline-container-orgd8edd57" class="outline-3">
<h3 id="orgd8edd57"><span class="section-number-3">7.2</span> Bufler</h3>
<div class="outline-text-3" id="text-7-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(use-package bufler :ensure t)

</pre>
</div>
</div>
</div>

<div id="outline-container-orgf505628" class="outline-3">
<h3 id="orgf505628"><span class="section-number-3">7.3</span> Minibuffer</h3>
</div>

<div id="outline-container-org59d2f23" class="outline-3">
<h3 id="org59d2f23"><span class="section-number-3">7.4</span> Navigation in a buffer</h3>
<div class="outline-text-3" id="text-7-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;; Activates by typing s or S then two arbitrary chars and it will
;; jump the cursor to the position.
(use-package evil-snipe :ensure t
  :diminish evil-snipe-local-mode
  :init (evil-snipe-mode +1)
  :config (setq evil-snipe-scope 'visible))

(use-package avy :ensure t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org68acfa7" class="outline-3">
<h3 id="org68acfa7"><span class="section-number-3">7.5</span> Unique buffer names</h3>
<div class="outline-text-3" id="text-7-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(require 'uniquify)
(setq uniquify-buffer-name-style 'forward)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org91dfdf7" class="outline-2">
<h2 id="org91dfdf7"><span class="section-number-2">8</span> Custom packages</h2>
<div class="outline-text-2" id="text-8">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-24 Thu&gt;</span></span>
Some packages are not in MELPA, so we need either download them manually
or have some mechanism doing that for us.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; Load custom packages
(add-to-list 'load-path "~/.emacs.d/packages")
(load "visit-source")
</pre>
</div>
</div>

<div id="outline-container-org7cbfe8f" class="outline-3">
<h3 id="org7cbfe8f"><span class="section-number-3">8.1</span> <span class="done DONE">DONE</span> Figure out how to download packages from Github url</h3>
<div class="outline-text-3" id="text-8-1">
<p>
Use straight.el.
</p>


<p>
<a href="https://github.com/turbo-cafe/flymake-kondor">Flymake-kondor</a> repo has an example how to do it:
</p>

<pre class="example">
(el-get-bundle
 flymake-kondor
 :url "https://raw.githubusercontent.com/turbo-cafe/flymake-kondor/master/flymake-kondor.el"
 (add-hook 'clojure-mode-hook #'flymake-kondor-setup))
</pre>
</div>
</div>
</div>

<div id="outline-container-org28adb1e" class="outline-2">
<h2 id="org28adb1e"><span class="section-number-2">9</span> Getting help, documentation</h2>
<div class="outline-text-2" id="text-9">
<dl class="org-dl">
<dt><code>C-h</code>, <code>F1</code></dt><dd>open help key drawer</dd>
<dt><code>F1 v</code>, <code>describe-varriable</code></dt><dd>Describe variable</dd>
<dt><code>F1 f</code>, <code>describe-function</code></dt><dd>Describe function</dd>
</dl>
</div>

<div id="outline-container-orgee52951" class="outline-3">
<h3 id="orgee52951"><span class="section-number-3">9.1</span> Info mode</h3>
<div class="outline-text-3" id="text-9-1">
<dl class="org-dl">
<dt><code>&lt;backspace&gt;</code></dt><dd>go back</dd>
</dl>
</div>
</div>

<div id="outline-container-org5497330" class="outline-3">
<h3 id="org5497330"><span class="section-number-3">9.2</span> <span class="done DONE">DONE</span> Integrate DevDocs?</h3>
<div class="outline-text-3" id="text-9-2">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-24 Thu&gt;</span></span>
I've found the blog post <a href="https://scripter.co/accessing-devdocs-from-emacs/">Accessing Devdocs from Emacs</a> which suggests
using <code>devdocs-lookup</code> package.
</p>

<p>
It's not published to MELPA, so we need to download it from Github. For now I'll do it manually using <code>curl</code>
and save to custom packages folder ~/code/dotfiles/emacs.d/packages .
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; (use-package devdocs-lookup :ensure t) -- doesn't work since not on MELPA
(load "devdocs-lookup")
(devdocs-setup)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgfa6dc62" class="outline-2">
<h2 id="orgfa6dc62"><span class="section-number-2">10</span> Modifier keys</h2>
<div class="outline-text-2" id="text-10">
<p>
Control is control, and I also changed Caps Lock to Control in the
Keyboard preferences in macOS.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq
  mac-right-command-modifier 'super  ;; Both command keys are 'Super'
  mac-command-modifier 'super
  mac-option-modifier 'meta ;; Option or Alt is naturally 'Meta'
  mac-right-option-modifier 'nil) ;; Right Alt (option) can be used to enter symbols like em dashes '—' and euros '€' and stuff.
</pre>
</div>
</div>
</div>

<div id="outline-container-org04c8555" class="outline-2">
<h2 id="org04c8555"><span class="section-number-2">11</span> Tweaking usage on macOS</h2>
<div class="outline-text-2" id="text-11">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq ns-use-native-fullscreen nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-org684aa00" class="outline-2">
<h2 id="org684aa00"><span class="section-number-2">12</span> Sane defaults</h2>
<div class="outline-text-2" id="text-12">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; Smoother and nicer scrolling
(setq
  scroll-margin 0
  scroll-step 1
  next-line-add-newlines t
  visible-bell nil
  scroll-conservatively 10000
  scroll-preserve-screen-position t
  mouse-wheel-follow-mouse t
  mouse-wheel-scroll-amount '(1 ((shift) . 1)))

(setq-default
  auto-save-default nil    ;; Don't bother with auto save
  make-backup-files nil    ;; and backups.
  delete-by-moving-to-trash t  ;; Move file to trash instead of removing.
  indent-tabs-mode nil)        ;; Indent using spaces by default

;; Revert (update) buffers automatically when underlying files are changed externally.
(global-auto-revert-mode t)

(setq
  inhibit-startup-message t              ;; Don't show the startup message...
  inhibit-startup-screen t               ;; ... or screen
  cursor-in-non-selected-windows nil     ;; Hide the cursor in inactive windows
  ;echo-keystrokes 0.1                   ;; Show keystrokes right away, don't show the message in the scratch buffer
  initial-scratch-message nil            ;; Empty scratch buffer
  ;initial-major-mode 'org-mode           ;; Org mode by default in *scratch* buffer
  sentence-end-double-space nil          ;; Sentences should end in one space
  confirm-kill-emacs 'y-or-n-p           ;; y and n instead of yes and no when quitting
  help-window-select t                   ;; Select help window so it's easy to quit it with 'q'
  large-file-warning-threshold 10000000  ;; Warn only when opening files bigger than 10MB
  )

(fset 'yes-or-no-p 'y-or-n-p)      ; y and n instead of yes and no everywhere else
(delete-selection-mode 1)          ; Delete selected text when typing
(global-unset-key (kbd "s-p"))     ; Don't print, later =s-p= remapped to open files in the project

</pre>
</div>
</div>
</div>

<div id="outline-container-org01d55af" class="outline-2">
<h2 id="org01d55af"><span class="section-number-2">13</span> Recent files</h2>
<div class="outline-text-2" id="text-13">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;; (defmacro with-suppressed-message (&amp;rest body)
;;   "Suppress new messages temporarily in the echo area and the
;;   `*Messages*' buffer while BODY is evaluated."
;;   (declare (indent 0))
;;   (let ((message-log-max nil))
;;     `(with-temp-message (or (current-message) "") ,@body)))

;; (setq save-silently t)
;; (with-suppressed-message (recentf-save-list))

(defun pp/recentf-save-list ()
  "Save recentf list supressing message."
  (let ((inhibit-message t)) (recentf-save-list)))

(use-package recentf
  :init
  (recentf-mode 1)
  (run-at-time "5 min" 300 'pp/recentf-save-list)
  :config
  (setq
    create-lockfiles nil
    recentf-max-menu-items 20
    recentf-max-saved-items 1000))
</pre>
</div>
</div>

<div id="outline-container-orgbe0d973" class="outline-3">
<h3 id="orgbe0d973"><span class="section-number-3">13.1</span> When switching to Emacs a Warning issued "recentf mode: Non-character input-event"</h3>
<div class="outline-text-3" id="text-13-1">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-12-08 Tue&gt;</span></span>
<a href="https://github.com/syl20bnr/spacemacs/issues/5554">https://github.com/syl20bnr/spacemacs/issues/5554</a>
</p>

<ul class="org-ul">
<li>I added <code>setq create-lockfiles nil</code>, let's see if it helps - looks
like not really.</li>
</ul>
</div>
</div>

<div id="outline-container-orgb05b05f" class="outline-3">
<h3 id="orgb05b05f"><span class="section-number-3">13.2</span> Opening files</h3>
<div class="outline-text-3" id="text-13-2">
<p>
I use <code>pp/visit-or-open</code> function, bound to <code>s-o</code> globally.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/visit-or-open ()
  "Try to 'visit-source', if fail, then fallback to 'find-file'."
  (interactive)
  (or
    (visit-source)
    (call-interactively 'find-file)))
</pre>
</div>
</div>

<div id="outline-container-org7ccb7f1" class="outline-4">
<h4 id="org7ccb7f1"><span class="section-number-4">13.2.1</span> <span class="todo TODO">TODO</span> Remove trailing dot from text under cursor before trying to <code>visit-source</code></h4>
<div class="outline-text-4" id="text-13-2-1">
<p>
Acceptance: having cursor above ~/repos/dotfiles/emacs.d/packages.
should open the folder in Dired.
</p>

<p>
Maybe also don't take into account other Org-related markup, like
<code>./filename.txt</code>.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org9e27750" class="outline-2">
<h2 id="org9e27750"><span class="section-number-2">14</span> Working with lists and hash-maps</h2>
<div class="outline-text-2" id="text-14">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package dash :ensure t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd6734b6" class="outline-2">
<h2 id="orgd6734b6"><span class="section-number-2">15</span> Clipboard / Copy / Yank / Paste / Delete</h2>
<div class="outline-text-2" id="text-15">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-11-22 Sun&gt;</span></span>
</p>

<p>
Shortcuts:
</p>

<dl class="org-dl">
<dt><code>C-y</code></dt><dd>yank – paste from Emacs' clipboard</dd>
</dl>


<div class="org-src-container">
<pre class="src src-emacs-lisp">;; We need Emacs kill ring and system clipboard to be
;; independent. Simpleclip is the solution to that.
(use-package simpleclip :ensure t
  :init (simpleclip-mode 1))

(defun pp/copy-file-name-to-clipboard ()
  "Copy the current buffer file name to the clipboard."
  (interactive)
  (let ((filename (if (equal major-mode 'dired-mode)
                      default-directory
                      (file-name-nondirectory (buffer-file-name)))))
    (when filename
      (simpleclip-set-contents filename)
      (message "Copied buffer file name '%s' to the clipboard." filename))))

(defun pp/copy-file-path-to-clipboard ()
  "Copy the current buffer file path to the clipboard."
  (interactive)
  (let ((filepath (if (equal major-mode 'dired-mode)
                      default-directory
                      (buffer-file-name))))
    (when filepath
      (simpleclip-set-contents filepath)
      (message "Copied buffer file path '%s' to the clipboard." filepath))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6372088" class="outline-2">
<h2 id="org6372088"><span class="section-number-2">16</span> Calendar</h2>
<div class="outline-text-2" id="text-16">
<p>
<a href="https://www.emacswiki.org/emacs/CalendarLocalization">https://www.emacswiki.org/emacs/CalendarLocalization</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(setq calendar-week-start-day 1)

</pre>
</div>
</div>
</div>

<div id="outline-container-org371dfbe" class="outline-2">
<h2 id="org371dfbe"><span class="section-number-2">17</span> Working with text</h2>
<div class="outline-text-2" id="text-17">
</div>
<div id="outline-container-org0a82d73" class="outline-3">
<h3 id="org0a82d73"><span class="section-number-3">17.1</span> Google Translate</h3>
<div class="outline-text-3" id="text-17-1">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-11-19 Thu&gt;</span></span>
</p>
<ul class="org-ul">
<li><code>go-translate</code> - for translating word under cursor (with prompt)</li>
<li><code>C-n</code>, <code>C-p</code> - to change language sequences when prompted</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package go-translate :ensure t
  :config
  (setq go-translate-local-language "en"
        go-translate-target-language "ru"
        go-translate-extra-directions '(("nl" . "en"))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1daa411" class="outline-3">
<h3 id="org1daa411"><span class="section-number-3">17.2</span> Text Editing</h3>
<div class="outline-text-3" id="text-17-2">
<ul class="org-ul">
<li><code>fill-paragraph</code>, <code>M-q</code> - wraps long-lined paragraph at 80 points</li>
<li><code>transpose-word</code>, <code>M-t</code> - moves word under cursor to the right,
respecting non-word symbolñs</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
;; Expand-region allows to gradually expand selection inside words,
;; sentences, expressions, etc.
(use-package expand-region :ensure t)

;; Move-text lines around with meta-up/down.
(use-package move-text :ensure t)

;; Wrap text, surround text, surround quotes.
(use-package wrap-region :ensure t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org17db7bf" class="outline-3">
<h3 id="org17db7bf"><span class="section-number-3">17.3</span> Join lines</h3>
<div class="outline-text-3" id="text-17-3">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-24 Thu&gt;</span></span>
</p>

<p>
Usually I just use <code>J</code> (<code>evil-join</code>), but if I need to wrap each line into quote,
this is the helper function.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/arrayify (start end quote)
  "Join lines from START to END, surrounding each line with QUOTE.

Source: https://news.ycombinator.com/item?id=22131815"
  (interactive "r\nMQuote: ")
  (let ((insertion
         (mapconcat
          (lambda (x) (format "%s%s%s" quote x quote))
          (split-string (buffer-substring start end)) ", ")))
    (delete-region start end)
    (insert insertion)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org216e9b7" class="outline-3">
<h3 id="org216e9b7"><span class="section-number-3">17.4</span> Wrap lines on a screen, visual line mode</h3>
<div class="outline-text-3" id="text-17-4">
<pre class="example">
(visual-line-mode 1)
</pre>
</div>
</div>
</div>

<div id="outline-container-org9c777cc" class="outline-2">
<h2 id="org9c777cc"><span class="section-number-2">18</span> File management / Dired</h2>
<div class="outline-text-2" id="text-18">
<p>
<a href="https://www.gnu.org/software/emacs/refcards/pdf/dired-ref.pdf">Cheatsheet</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/dired-sidebar-view-file ()
  "Open file under cursor then switch back to dired-sidebar."
  (interactive)
  (dired-sidebar-find-file)
  (dired-sidebar-jump-to-sidebar))

(defun pp/dired-hook ()
  "Hook for 'dired'."
  (all-the-icons-dired-mode)
  (unless (file-remote-p default-directory)
    (auto-revert-mode)))

(use-package dired-single :ensure t)

(use-package dired
  :init
    (put 'dired-find-alternate-file 'disabled nil)
  :hook (dired-mode-hook . pp/dired-hook)
  :bind (:map dired-mode-map
              (("RET" . dired-single-buffer)
               ("DEL" . dired-single-up-directory)
               ("s" . evil-snipe-s)
               ("S" . evil-snipe-S))))

(use-package dired-sidebar :ensure t
  :commands dired-sidebar-toggle-sidebar)

(use-package all-the-icons-dired :ensure t
  :diminish)

(use-package treemacs :ensure t)


;; Delete trailing spaces and add new line in the end of a file on save.
(add-hook 'before-save-hook 'delete-trailing-whitespace)
(setq require-final-newline t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb046250" class="outline-2">
<h2 id="orgb046250"><span class="section-number-2">19</span> Undo and redo</h2>
<div class="outline-text-2" id="text-19">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; Linear undo and redo.
(use-package undo-tree :ensure t
  :diminish undo-tree-mode
  :init
  (progn
    (global-undo-tree-mode)
    (setq undo-tree-history-directory-alist '(("." . "~/.emacs.d/tmp/undo"))
          undo-tree-auto-save-history nil
          undo-tree-visualizer-timestamps t
          undo-tree-visualizer-diff t
          undo-tree-limit 1000000)
    (setq-default undo-limit 1000000)))

</pre>
</div>
</div>
</div>

<div id="outline-container-org260a981" class="outline-2">
<h2 id="org260a981"><span class="section-number-2">20</span> Visuals</h2>
<div class="outline-text-2" id="text-20">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package highlight-indent-guides :ensure t
  :config
  (setq highlight-indent-guides-method 'character))

(global-hl-line-mode -1)

(use-package all-the-icons :ensure t)

(use-package rainbow-mode :ensure t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org8d7b125" class="outline-2">
<h2 id="org8d7b125"><span class="section-number-2">21</span> Mode line, mode-line, Status Bar</h2>
<div class="outline-text-2" id="text-21">
<p>
<a href="http://ergoemacs.org/emacs/modernization_mode_line.html">Xah Lee's post on Mode line.</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; (use-package smart-mode-line :ensure t
;;   :config
;;   (setq sml/theme 'light
;;         sml/name-width 40
;;         sml/mode-width 'full
;;         sml/no-confirm-load-theme t
;;         sml/not-modified-char " "
;;         sml/numbers-separator "")
;;   (add-to-list 'sml/replacer-regexp-list '("^~/go/src/github.com/FindHotel/" ":GoFH:") t)
;;   (add-to-list 'sml/replacer-regexp-list '("^~/repos/dotfiles/emacs.d/" ":ED:") t)
;;   (sml/setup))

;; (use-package mood-line
;;   :config
;;     (mood-line-mode 1))

;; (use-package doom-modeline
;;   :ensure t
;;   :init (doom-modeline-mode 1)
;;   :config
;;   (setq doom-modeline-minor-modes nil
;;         doom-modeline-height 0 ;; uses actual height of chars
;;         doom-modeline-bar-width 1
;;         doom-modeline-enable-word-count t
;;         doom-modeline-buffer-encoding nil))

;; (use-package ns-auto-titlebar
;;  :config
 ;;   (when (eq system-type 'darwin) (ns-auto-titlebar-mode)))

;; Hide minor modes from modeline.
(use-package rich-minority :ensure t
  :config
    (add-to-list 'rm-blacklist " $") ;; rich-minority itself
    (add-to-list 'rm-blacklist " WE")
    (add-to-list 'rm-blacklist " Ind")  ;; org-indent-mode
    (add-to-list 'rm-blacklist " ElDoc") ;; Emacs Lisp documentation
    (add-to-list 'rm-blacklist " fix")  ;; eslintd-fix-mode
    (add-to-list 'rm-blacklist " s3ed")
    (rich-minority-mode))

(setq-default echo-bell-background "Gray")
(load "echo-bell")
(echo-bell-mode)

</pre>
</div>

<pre class="example">
(message mode-name)
(message mode-line-modes)
</pre>
</div>

<div id="outline-container-orga144c14" class="outline-4">
<h4 id="orga144c14"><span class="section-number-4">21.0.1</span> <span class="todo TODO">TODO</span> mode-line resets when locally</h4>
<div class="outline-text-4" id="text-21-0-1">
<p>
For some reason mode-line turns to contain only buffer name
after some time, probably some package/mode sets it.
The example below resets it to default original value.
</p>

<p>
I was suspecting that this happens when I open a Go file, probably
something with go-mode-hook.
</p>

<p>
Can't reproduce on a fresh opened Emacs.
</p>

<p>
Now I suspect eglot.
</p>

<pre class="example">
(describe-variable 'mode-line-format)

(setq-default mode-line-format
  '("%e" mode-line-front-space
    mode-line-mule-info mode-line-client mode-line-modified
    mode-line-remote mode-line-frame-identification
    mode-line-buffer-identification " " mode-line-position
    evil-mode-line-tag (vc-mode vc-mode)
    "  " mode-line-modes mode-line-misc-info mode-line-end-spaces))
</pre>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/reset-mode-line-format ()
  "Klll local variable mode-line-format resetting it to the global value."
  (interactive)
  (kill-local-variable 'mode-line-format))

(defun pp/toggle-hide-mode-line ()
  "Toggle mode-line visibility in current buffer.
Source: https://gist.github.com/rnkn/a522429ed7e784ae091b8760f416ecf8"
  (interactive)
  (if mode-line-format
      (setq-local mode-line-format nil)
    (kill-local-variable 'mode-line-format)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0ba0b0f" class="outline-2">
<h2 id="org0ba0b0f"><span class="section-number-2">22</span> Font</h2>
<div class="outline-text-2" id="text-22">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/set-font (font size)
  "Use FONT with SIZE if it's present in the system."
 (when (member font (font-family-list))
  (set-face-attribute 'default nil :font (format "%s %d" font size))))

;; (pp/set-font "JetBrains Mono" 12)
(pp/set-font "PragmataPro" 14)
;;(pp/set-font "Iosevka" 14)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaa474ae" class="outline-2">
<h2 id="orgaa474ae"><span class="section-number-2">23</span> Color themes</h2>
<div class="outline-text-2" id="text-23">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/disable-all-themes ()
  "Disable all custom enabled themes.
Found on http://www.greghendershott.com/2017/02/emacs-themes.html."
  (interactive)
  (mapc #'disable-theme custom-enabled-themes))

(defun pp/load-theme (theme)
  "Load THEME as current theme."
  (interactive "stheme: ")
  (pp/disable-all-themes)
  (load-theme theme t)
  (pp/set-font "PragmataPro" 14)
  ;(pp/set-font "Iosevka" 14)
)

(setq-default line-spacing 2)

;; (use-package ayu-theme :ensure t)
;; (use-package solarized-theme)
;; (use-package doom-themes)
;; (use-package ample-theme :ensure t)
;; (use-package quasi-monochrome-theme :ensure t)
;; (use-package monochrome-theme :ensure t)
(use-package modus-themes :ensure t)
(use-package faff-theme :ensure t)
;; (use-package horizon-theme :ensure t)

;; 256 colors in term
(use-package eterm-256color
  :hook (term-mode-hook . eterm-256color-mode))

(blink-cursor-mode 0) ;; disable blinking cursor
</pre>
</div>

<pre class="example">
;; light themes
(pp/load-theme 'leuven)
(pp/load-theme 'tsdh-light)
(pp/load-theme 'monochrome-bright)
(progn
  (setq modus-operandi-theme-no-mixed-fonts t)
  (pp/load-theme 'modus-operandi))
(pp/load-theme 'whiteboard)

;; sepia themes
(pp/load-theme 'faff)

;; dark themes
(pp/load-theme 'ayu-dark)
(pp/load-theme 'wombat)
(pp/load-theme 'tsdh-dark)
(pp/load-theme 'ayu-grey)
(pp/load-theme 'monochrome)
(pp/load-theme 'quasi-monochrome)
(progn
  (setq modus-vivendi-theme-no-mixed-fonts t)
  (pp/load-theme 'modus-vivendi))
(pp/load-theme 'ample)
(pp/load-theme 'ample-flat)
</pre>

<pre class="example">
(setq-default
 header-line-format
 (list
  "  "
  '(:eval (let ((name (buffer-name)))
            (cond ((not buffer-file-truename)
                   (propertize name 'face 'bold))
                  ((equal name (file-name-nondirectory buffer-file-truename))
                   (concat (propertize
                            (f-filename buffer-file-truename)
                            'face 'bold)
                           " "
                           (f-dirname buffer-file-truename)
                           "/…"))
                  (t
                   (concat (propertize name 'face 'bold)
                           " "
                           buffer-file-truename)))))

  ;; Right aligned
  '(:eval (let* ((right-text (format-mode-line mode-name)))
            (concat (propertize
                     " " 'display
                     `((space :align-to (- (+ right right-fringe right-margin)
                                           ,(+ 3 (string-width right-text))))))
                    right-text)))))
</pre>
</div>

<div id="outline-container-org959faa6" class="outline-3">
<h3 id="org959faa6"><span class="section-number-3">23.1</span> Faff theme changed highlighting of Org headers</h3>
<div class="outline-text-3" id="text-23-1">
<p>
On <span class="timestamp-wrapper"><span class="timestamp">[2020-11-26 Thu] </span></span> in the commit <a href="https://github.com/WJCFerguson/emacs-faff-theme/commit/8bf375a218cb242fa6fad9804001f213bc2f9d56">8bf375a</a> in faff theme the
</p>
</div>
</div>

<div id="outline-container-org864c8d7" class="outline-3">
<h3 id="org864c8d7"><span class="section-number-3">23.2</span> Switch between dark and light mode in macOS</h3>
<div class="outline-text-3" id="text-23-2">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-12-12 Sat&gt;</span></span>
</p>

<p>
<a href="https://github.com/d12frosted/homebrew-emacs-plus#system-appearance-change">System appearance change</a> in Emacs Plus.
</p>

<p>
<code>emacs-mac-port</code> does have this built-in.
<code>emacs-plus</code> allows to add hook on changing system appearance.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/apply-appearance (appearance)
  "Load theme, taking current system APPEARANCE into consideration."
  (mapc #'disable-theme custom-enabled-themes)
  (pcase appearance
    ('light (progn (setq modus-operandi-theme-no-mixed-fonts t)
                   (load-theme 'modus-operandi t)))
    ('dark (progn (setq modus-vivendi-theme-no-mixed-fonts t)
                   (load-theme 'modus-vivendi t))))
  (pp/set-font "PragmataPro" 14))

(add-hook 'ns-system-appearance-change-functions #'pp/apply-appearance)
</pre>
</div>

<pre class="example">
(pp/apply-appearance 'dark)
(pp/apply-appearance 'light)
</pre>
</div>
</div>
</div>

<div id="outline-container-org257f127" class="outline-2">
<h2 id="org257f127"><span class="section-number-2">24</span> Line numbers</h2>
<div class="outline-text-2" id="text-24">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(defun pp/line-numbers-on ()
  "Turn on showing line numbers."
  (interactive)
  (setq display-line-numbers 'relative))

(defun pp/line-numbers-off ()
  "Turn on showing line numbers."
  (interactive)
  (setq display-line-numbers nil))

(add-hook 'text-mode-hook #'pp/line-numbers-on)
(add-hook 'prog-mode-hook #'pp/line-numbers-on)
(add-hook 'org-mode-hook #'pp/line-numbers-off)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaccade0" class="outline-2">
<h2 id="orgaccade0"><span class="section-number-2">25</span> Keybindings</h2>
<div class="outline-text-2" id="text-25">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;; Use ESC as universal get me out of here command
(define-key key-translation-map (kbd "ESC") (kbd "C-g"))

(use-package which-key :ensure t
  :diminish which-key-mode
  :config
    (which-key-mode)
    (which-key-setup-side-window-bottom)
    ;;(which-key-setup-side-window-right-bottom)
    (setq which-key-sort-order 'which-key-key-order-alpha
          which-key-idle-delay 0.5))
</pre>
</div>
</div>

<div id="outline-container-org72c6b79" class="outline-3">
<h3 id="org72c6b79"><span class="section-number-3">25.1</span> General, package for setting keybindings</h3>
<div class="outline-text-3" id="text-25-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package general :ensure t)

(general-define-key
  ;;"&lt;tab&gt;" 'org-cycle
  "s-s" 'save-buffer
  "s-S" 'write-file              ;; save as
  "s-a" 'mark-whole-buffer       ;; select all
  "s-z" 'undo-tree-undo
  "s-Z" 'undo-tree-redo
  "s-;" 'comment-line
  "s-." 'company-complete
  ;; windows
  "s-1" 'delete-other-windows
  "s-2" 'split-window-below
  "s-3" 'split-window-right
  "s-w" 'delete-window
  ;; going around
  "s-j" 'previous-buffer
  "s-k" 'next-buffer
  "s-b" 'consult-buffer
  "s-n" 'switch-to-buffer
  ;; searching
  "C-s" 'isearch-forward
  "C-r" 'isearch-backward
  "C-l" 'consult-line
  "C-;" 'avy-goto-char
  "s-r" 'consult-recent-file
  "s-o" 'pp/visit-or-open
  "s-p" 'project-find-file
  "s-f" 'pp/consult-ripgrep ;; fuzzy search in the current project
  "s-F" 'deadgrep
  ;; modes
  "s-t" 'eshell
  "s-g" 'magit-status
  "M-x" 'execute-extended-command
  ;; function keys
  "&lt;f5&gt;" 'deadgrep
  "&lt;f6&gt;" 'flymake-show-diagnostics-buffer
  "&lt;f8&gt;" 'dired-sidebar-toggle-sidebar
  ;; text manipulation
  "s-'" 'er/expand-region
  "s-\\" 'er/contract-region
  "&lt;M-up&gt;" 'move-text-up
  "&lt;M-down&gt;" 'move-text-down)

(general-define-key
 :states '(normal)
 "C-k" 'evil-scroll-up
 "C-j" 'evil-scroll-down
 "C-r" 'isearch-backward
 ;"*" 'swiper-thing-at-point
)

(general-define-key :states '(normal) :prefix "SPC"
  ;"1" 'pp/switch-to-scratch-buffer
  ;"2" 'lispy-arglist-inline
  "a" 'org-agenda
  "," 'org-insert-structure-template
  "[" 'flymake-goto-previous-error
  "]" 'flymake-goto-next-error
  "d" 'projectile-find-dir ;'counsel-projectile-find-dir
  "j" 'dired-jump
  "k" 'kill-this-buffer
  "n" 'deft ; mnemonics - notes
  "p" 'project-switch-project ;'counsel-projectile-switch-project
  "h" 'highlight-symbol ;; mnemonics - highlight
  "l" 'lispy-mode
  "w" 'visual-line-mode
  "t" 'projectile-test-project)

(general-define-key :states '(normal) :prefix "C-x"
  "C-o" 'find-file)

(general-define-key :states '(visual)
 "SPC" 'er/expand-region
 "DEL" 'er/contract-region)

(general-define-key :states '(insert)
  "C-a" 'beginning-of-line
  "C-e" 'end-of-line
  "C-n" 'next-line
  "C-p" 'previous-line)
</pre>
</div>
</div>
</div>

<div id="outline-container-org1f95290" class="outline-3">
<h3 id="org1f95290"><span class="section-number-3">25.2</span> Commenting/uncommenting</h3>
<div class="outline-text-3" id="text-25-2">
<dl class="org-dl">
<dt><code>M-;</code>, <code>comment-dwim</code></dt><dd>in Command mode will add comment to the end of line, in Visual mode will comment the whole line</dd>
<dt><code>C-x C-;</code>, <code>s-;</code>, <code>comment-line</code></dt><dd>will comment the whole line, but works strange in Org Babel</dd>
</dl>

<p>
Good description in <a href="http://ergoemacs.org/misc/emacs_comment-line_vs_comment-dwim.html">http://ergoemacs.org/misc/emacs_comment-line_vs_comment-dwim.html</a>.
</p>
</div>
</div>
</div>

<div id="outline-container-orgd329047" class="outline-2">
<h2 id="orgd329047"><span class="section-number-2">26</span> Moving around</h2>
<div class="outline-text-2" id="text-26">
</div>
<div id="outline-container-org922f7c9" class="outline-3">
<h3 id="org922f7c9"><span class="section-number-3">26.1</span> Evil</h3>
<div class="outline-text-3" id="text-26-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package evil
  ;; :init (setq evil-want-C-u-scroll t)  ;; I'm using C-u as universal argument instead.
  :config
  (evil-set-undo-system 'undo-tree) ;; Evil made undo-tree optional, I'm setting it back here. Source: https://github.com/syl20bnr/spacemacs/issues/14036
  (evil-mode 1))

(use-package evil-surround :ensure t
  :config
  (global-evil-surround-mode 1))
</pre>
</div>

<ul class="org-ul">
<li><a href="https://wikemacs.org/index.php/Evil#Enter_an_emacs_mode_in_a_given_state">Enter an Emacs mode in a given state</a></li>
</ul>
</div>
</div>

<div id="outline-container-org3bdbca1" class="outline-3">
<h3 id="org3bdbca1"><span class="section-number-3">26.2</span> Xah Fly Keys</h3>
<div class="outline-text-3" id="text-26-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package xah-fly-keys
  :commands xah-fly-keys
  :config
    ;; (xah-fly-keys 1)
    (xah-fly-keys-set-layout 'qwerty))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3ab5789" class="outline-3">
<h3 id="org3ab5789"><span class="section-number-3">26.3</span> Moving back</h3>
<div class="outline-text-3" id="text-26-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package goto-last-change
  :ensure
  :bind ("&lt;s-backspace&gt;" . goto-last-change))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org2871736" class="outline-2">
<h2 id="org2871736"><span class="section-number-2">27</span> Window management</h2>
<div class="outline-text-2" id="text-27">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq
   split-height-threshold 80
   split-width-threshold 160)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf95b53b" class="outline-2">
<h2 id="orgf95b53b"><span class="section-number-2">28</span> Project management</h2>
<div class="outline-text-2" id="text-28">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package projectile :ensure t
  :config
    (setq projectile-git-submodule-command "")
    (setq projectile-mode-line-function '(lambda () (format " #%s" (projectile-project-name))))
    (projectile-mode +1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5efb517" class="outline-2">
<h2 id="org5efb517"><span class="section-number-2">29</span> Improving M-x</h2>
<div class="outline-text-2" id="text-29">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package smex :ensure t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org8c18e72" class="outline-2">
<h2 id="org8c18e72"><span class="section-number-2">30</span> Selectrum, Marginalia, Consult for completion</h2>
<div class="outline-text-2" id="text-30">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-12-20 Sun&gt; </span></span> <span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-14 Thu&gt;</span></span>
Replaces Ivy+Counsel.
</p>
</div>

<div id="outline-container-orgd53c6dd" class="outline-3">
<h3 id="orgd53c6dd"><span class="section-number-3">30.1</span> Selectrum</h3>
<div class="outline-text-3" id="text-30-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package selectrum :ensure t
  :init (selectrum-mode))

(use-package selectrum-prescient :ensure t
  :init (selectrum-prescient-mode +1))

(use-package completing-read-xref
  :straight (completing-read-xref :type git :host github :repo "travitch/completing-read-xref.el")
  :commands (completing-read-xref-show-xrefs completing-read-xref-show-xrefs)
  :init (setq xref-show-definitions-function 'completing-read-xref-show-defs))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb6f78a3" class="outline-3">
<h3 id="orgb6f78a3"><span class="section-number-3">30.2</span> Prescient - Frecency-based candidate sorting, also offers filtering</h3>
<div class="outline-text-3" id="text-30-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package prescient :ensure t
  :config
  (prescient-persist-mode +1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org139b3ac" class="outline-3">
<h3 id="org139b3ac"><span class="section-number-3">30.3</span> Marginalia - additional information on completion</h3>
<div class="outline-text-3" id="text-30-3">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-04 Mon&gt;</span></span>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package marginalia :ensure t
  :init
  (marginalia-mode)
  (setq marginalia-annotators '(marginalia-annotators-heavy marginalia-annotators-light)
        marginalia-truncate-width 300
        marginalia-separator-threshold 3000
        marginalia-margin-threshold 135))
</pre>
</div>
</div>

<div id="outline-container-org9307126" class="outline-4">
<h4 id="org9307126"><span class="section-number-4">30.3.1</span> <span class="todo TODO">TODO</span> Fix wrong indentation in <code>M-x</code> when Emacs frame is full-screen on 27" display</h4>
<div class="outline-text-4" id="text-30-3-1">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-13 Wed&gt;</span></span>
</p>

<p>
Can't make it working on both 27" display and on MacBook display.
</p>

<pre class="example">
(progn
  (marginalia-mode -1)
  (setq marginalia-truncate-width 300
        marginalia-separator-threshold 3000
        marginalia-margin-threshold 165)
  (marginalia-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-org7425c78" class="outline-3">
<h3 id="org7425c78"><span class="section-number-3">30.4</span> Consult</h3>
<div class="outline-text-3" id="text-30-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package consult :ensure t)

;(use-package icomplete-vertical :ensure t
;  :init (icomplete-vertical-mode))

(defun pp/consult-ripgrep ()
  "Launches ripgrep in the current project root."
  (interactive)
  (consult-ripgrep (project-root (project-current))))
</pre>
</div>
</div>

<div id="outline-container-org6840fef" class="outline-4">
<h4 id="org6840fef"><span class="section-number-4">30.4.1</span> Consult is broken after upgrade</h4>
<div class="outline-text-4" id="text-30-4-1">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-14 Thu&gt;</span></span>
</p>

<ul class="org-ul">
<li><code>consult-selectrum</code> is not longer exists, bundled inside consult,
but it not symlinked when installing with straight.</li>
</ul>

<blockquote>
<p>
Error in post-command-hook (selectrum&#x2013;minibuffer-post-command-hook):
(wrong-type-argument number-or-marker-p nil)
</p>


<p>
Error in post-command-hook (icomplete-post-command-hook):
(wrong-type-argument number-or-marker-p nil)
</p>
</blockquote>
</div>
</div>
</div>
</div>

<div id="outline-container-orged49d93" class="outline-2">
<h2 id="orged49d93"><span class="section-number-2">31</span> git, version control system, magit</h2>
<div class="outline-text-2" id="text-31">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package magit :ensure t
  :hook (magit-mode-hook . turn-off-evil-snipe-override-mode))

(use-package forge :ensure t
  :after magit)

(use-package ghub :ensure t
  :after magit)

(use-package git-gutter :ensure t
  :diminish
  :init (global-git-gutter-mode 't)
  :config
    (custom-set-variables
      '(git-gutter:modified-sign "~") ;; two space
      '(git-gutter:added-sign "+")    ;; multiple character is OK
      '(git-gutter:deleted-sign "-"))
    (set-face-background 'git-gutter:modified "purple")   ;; background color
    (set-face-background 'git-gutter:added "green")
    (set-face-background 'git-gutter:deleted "red")
    (set-face-foreground 'git-gutter:added "white")
    (set-face-foreground 'git-gutter:deleted "white"))
</pre>
</div>

<pre class="example">
(forge-pull)
(ghub-request "GET" "/user")
</pre>
</div>
</div>

<div id="outline-container-orgda2ed4f" class="outline-2">
<h2 id="orgda2ed4f"><span class="section-number-2">32</span> Code completion</h2>
<div class="outline-text-2" id="text-32">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package company :ensure t
  :diminish
  :hook (prog-mode-hook . company-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org359c666" class="outline-2">
<h2 id="org359c666"><span class="section-number-2">33</span> Org-mode&#xa0;&#xa0;&#xa0;<span class="tag"><span class="OrgMode">OrgMode</span></span></h2>
<div class="outline-text-2" id="text-33">
<ul class="org-ul">
<li><a href="https://www.gnu.org/software/emacs/refcards/pdf/orgcard.pdf">Org cheatsheet</a></li>
</ul>

<p>
Useful keybindings:
</p>
<dl class="org-dl">
<dt><code>C-c C-l</code>, <code>org-insert-link</code></dt><dd>if on url - uses it and prompts for description. <a href="https://orgmode.org/manual/Handling-Links.html#Handling-Links">Docs</a></dd>
</dl>

<pre class="example">
(describe-variable 'org-version)
</pre>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package org
  :config
  (setq
   org-startup-indented t
   org-src-tab-acts-natively t
   org-src-preserve-indentation t
   org-src-fontify-natively t
   org-log-into-drawer t
   org-log-done 'time
   org-export-backends '(html md)
   org-support-shift-select t
   org-directory "~/Documents/Notes"
   org-agenda-files '("~/Documents/Notes/pavel.org"
                      "~/.emacs.d/emacs-init.org"
                      "~/Documents/Projects/Blog/Clojure.org"
                      "~/code/fh/search-api/README.org"
                      "~/code/fh/hotel-explorer/README.org"
                      "~/Documents/FindHotel/fh.org")))

(use-package org-bullets :ensure t
  :hook (org-mode-hook . org-bullets-mode))
</pre>
</div>
</div>

<div id="outline-container-orgf4c78ec" class="outline-3">
<h3 id="orgf4c78ec"><span class="section-number-3">33.1</span> Org-babel, Babel, Org Babel&#xa0;&#xa0;&#xa0;<span class="tag"><span class="OrgBabel">OrgBabel</span></span></h3>
<div class="outline-text-3" id="text-33-1">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-11-23 Mon&gt; </span></span> <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-12-06 Sun&gt;</span></span>
</p>

<p>
Babel enables literate programming in Org Mode.
</p>

<dl class="org-dl">
<dt><code>&lt;s-TAB</code></dt><dd>start source block</dd>
<dt><code>&lt;e-TAB</code></dt><dd>start example block</dd>
<dt><code>C-c C-c</code></dt><dd>execute block</dd>
<dt><code>C-c '</code></dt><dd>edit this block in a separate buffer</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq-default org-confirm-babel-evaluate nil)

(org-babel-do-load-languages
 'org-babel-load-languages
 '((clojure . t)
   (emacs-lisp . t)
   (plantuml . t)
   (shell . t)
   (python . t)
   (restclient . t)
   (calc . t)))
</pre>
</div>
</div>

<div id="outline-container-orgbdd3d7c" class="outline-4">
<h4 id="orgbdd3d7c"><span class="section-number-4">33.1.1</span> <span class="todo TODO">TODO</span> Setup org-mode-babel for sql files</h4>
<div class="outline-text-4" id="text-33-1-1">
<ul class="org-ul">
<li>Should be able to run SQL in Snowflake</li>
</ul>
</div>
</div>

<div id="outline-container-org1711333" class="outline-4">
<h4 id="org1711333"><span class="section-number-4">33.1.2</span> <span class="done DONE">DONE</span> Setup org-mode-babel for shell</h4>
<div class="outline-text-4" id="text-33-1-2">
<div class="org-src-container">
<pre class="src src-sh">ls ~
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc5897fe" class="outline-4">
<h4 id="orgc5897fe"><span class="section-number-4">33.1.3</span> <span class="todo TODO">TODO</span> Setup org-mode-babel for clojure</h4>
<div class="outline-text-4" id="text-33-1-3">
<div class="org-src-container">
<pre class="src src-clojure">(+ 2 3)

(defn foo [x] x)
</pre>
</div>
</div>
</div>

<div id="outline-container-org554f5ef" class="outline-4">
<h4 id="org554f5ef"><span class="section-number-4">33.1.4</span> Example blocks</h4>
<div class="outline-text-4" id="text-33-1-4">
<div class="org-src-container">
<pre class="src src-shell">printf "Please wait (this can take a while)...\n"
sleep 5
printf "Done!\n"
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf3ac1f8" class="outline-4">
<h4 id="orgf3ac1f8"><span class="section-number-4">33.1.5</span> <span class="todo TODO">TODO</span> Try ob-async</h4>
<div class="outline-text-4" id="text-33-1-5">
<p>
Asynchronous src_block execution for org-babel
<a href="https://github.com/astahlman/ob-async">https://github.com/astahlman/ob-async</a>
</p>
</div>
</div>
<div id="outline-container-orgd8408ea" class="outline-4">
<h4 id="orgd8408ea"><span class="section-number-4">33.1.6</span> How to insert source code block?</h4>
<div class="outline-text-4" id="text-33-1-6">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-01-24 Fri&gt;</span></span>
</p>

<p>
<a href="https://emacs.stackexchange.com/a/19946">https://emacs.stackexchange.com/a/19946</a>
</p>

<dl class="org-dl">
<dt>In Org Mode prior to 9.2</dt><dd>Insert <code>&lt;s</code> and press <code>TAB</code></dd>
<dt>After 9.2</dt><dd><code>C-c C-,</code></dd>
</dl>

<p>
After upgrading to Emacs 27.1 <code>&lt;s</code> and <code>&lt;e</code> expansions stopped
working, the new shortcut is <code>C-c C-,</code> To get <code>&lt;s</code> and <code>&lt;e</code> working,
<a href="https://emacs.stackexchange.com/a/46992">this answer</a> on SO suggests using the following snippet.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(require 'org-tempo)
; (add-to-list 'org-modules 'org-tempo)
</pre>
</div>

<p>
but for some reason it didn't work for me, so I stick with <code>C-c C-,</code>
and also bind it to <code>SPC ,</code> in Evil Normal mode. As of
<span class="timestamp-wrapper"><span class="timestamp">[2020-11-23 Mon] </span></span> <code>&lt;s</code> works again.
</p>
</div>
</div>
</div>

<div id="outline-container-orgc253e79" class="outline-3">
<h3 id="orgc253e79"><span class="section-number-3">33.2</span> Org-agenda, Ora Agenda&#xa0;&#xa0;&#xa0;<span class="tag"><span class="OrgAgenda">OrgAgenda</span></span></h3>
<div class="outline-text-3" id="text-33-2">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-10-05 Mon&gt;</span></span>
</p>

<p>
To setup category either add <code>#+CATEGORY</code> to the file or use
<code>CATEGORY</code> property of an item. To setup a property use
<code>org-set-property</code>.
</p>
</div>
<div id="outline-container-orgeeed1a9" class="outline-4">
<h4 id="orgeeed1a9"><span class="section-number-4">33.2.1</span> <span class="done DONE">DONE</span> How to split agenda vertically?</h4>
<div class="outline-text-4" id="text-33-2-1">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-01-24 Fri&gt;</span></span>
</p>

<p>
There is such configuration from Castlemacs which did that damage:
</p>
<pre class="example">
;; This is rather radical, but saves from a lot of pain in the ass.
;; When split is automatic, always split windows vertically
(setq split-height-threshold 0)
(setq split-width-threshold nil)
</pre>

<p>
<a href="https://emacs.stackexchange.com/questions/39034/prefer-vertical-splits-over-horizontal-ones">https://emacs.stackexchange.com/questions/39034/prefer-vertical-splits-over-horizontal-ones</a>
<a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/See-variable-current-value.html">https://www.gnu.org/software/emacs/manual/html_node/eintr/See-variable-current-value.html</a>
</p>
</div>
</div>
<div id="outline-container-orgd2843da" class="outline-4">
<h4 id="orgd2843da"><span class="section-number-4">33.2.2</span> <span class="todo TODO">TODO</span> Alphapapa published org-super-agenda package to bring it to the next level</h4>
<div class="outline-text-4" id="text-33-2-2">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-11-22 Sun&gt;</span></span>
<a href="https://github.com/alphapapa/org-super-agenda">https://github.com/alphapapa/org-super-agenda</a>
<a href="https://www.reddit.com/r/emacs/comments/jy87i3/ann_orgsuperagenda_12_released/">https://www.reddit.com/r/emacs/comments/jy87i3/ann_orgsuperagenda_12_released/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-orga69f174" class="outline-3">
<h3 id="orga69f174"><span class="section-number-3">33.3</span> Org-QL, a query language for Org files&#xa0;&#xa0;&#xa0;<span class="tag"><span class="OrgQL">OrgQL</span></span></h3>
<div class="outline-text-3" id="text-33-3">
<p>
<a href="https://github.com/alphapapa/org-ql">https://github.com/alphapapa/org-ql</a>
</p>
</div>

<div id="outline-container-orgbf97daa" class="outline-4">
<h4 id="orgbf97daa"><span class="section-number-4">33.3.1</span> <span class="todo TODO">TODO</span> Try org-ql</h4>
</div>
</div>

<div id="outline-container-orgabc783f" class="outline-3">
<h3 id="orgabc783f"><span class="section-number-3">33.4</span> <span class="done DONE">DONE</span> How to automatically add creation metadata timestamp to Org-mode entry?</h3>
<div class="outline-text-3" id="text-33-4">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-24 Thu&gt;</span></span>
</p>

<p>
Links:
</p>
<ul class="org-ul">
<li><a href="https://orgmode.org/manual/Creating-Timestamps.html">https://orgmode.org/manual/Creating-Timestamps.html</a></li>
<li><a href="https://stackoverflow.com/questions/12262220/add-created-date-property-to-todos-in-org-mode">https://stackoverflow.com/questions/12262220/add-created-date-property-to-todos-in-org-mode</a></li>
</ul>

<p>
Use <code>org-expiry-insert-created</code> function.
</p>

<pre class="example">
(load "org-expiry")
(setq
  org-expiry-created-property-name "CREATED" ; Name of property when an item is created
  org-expiry-inactive-timestamps   t         ; Don't have everything in the agenda view
)
</pre>
</div>
</div>

<div id="outline-container-orga992f69" class="outline-3">
<h3 id="orga992f69"><span class="section-number-3">33.5</span> <span class="done DONE">DONE</span> Saving of fh.org (272K) takes significant time</h3>
<div class="outline-text-3" id="text-33-5">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-11-01 Sun&gt;</span></span>
</p>

<p>
The problem was in <code>undo-tree</code> mode which overtime grew significant
amount of undo changes.
</p>
</div>
</div>
</div>

<div id="outline-container-orgc22b8fc" class="outline-2">
<h2 id="orgc22b8fc"><span class="section-number-2">34</span> Outline-mode - folding and unfolding in Org-mode style</h2>
<div class="outline-text-2" id="text-34">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
;; (use-package outshine :ensure t) - way too complex

;; (use-package outline-magic :ensure t) - use org-cycle instead
;;  :config (setq-default outline-promotion-headings '("# * " "# ** " "# *** ")))

(setq-default outline-regexp "[*#]+")

(use-package emacs
  :config
  (defun pp/outline-minor-mode-hook ()
    (general-define-key
     :keymaps 'local
     "&lt;tab&gt;" 'org-cycle
     "M-p" 'outline-previous-heading
     "M-n" 'outline-next-heading))
  (add-hook 'outline-minor-mode-hook #'pp/outline-minor-mode-hook))
</pre>
</div>

<pre class="example">
(describe-variable 'outline-promotion-headings)
</pre>
</div>
</div>
<div id="outline-container-orgd22faf8" class="outline-2">
<h2 id="orgd22faf8"><span class="section-number-2">35</span> Eshell</h2>
<div class="outline-text-2" id="text-35">
<p>
<b>Links</b>
</p>
<ul class="org-ul">
<li><a href="https://ambrevar.xyz/emacs-eshell/">https://ambrevar.xyz/emacs-eshell/</a></li>
<li><a href="https://www.reddit.com/r/emacs/comments/6y3q4k/yes_eshell_is_my_main_shell/">https://www.reddit.com/r/emacs/comments/6y3q4k/yes_eshell_is_my_main_shell/</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(defun pp/eshell-prompt-function ()
  "Eshell prompt function."
  (format "%s\nλ " (abbreviate-file-name (eshell/pwd))))

(use-package eshell
  :config
  (setq-default eshell-history-size 100000
                eshell-prompt-regexp "^λ "
                eshell-prompt-function #'pp/eshell-prompt-function))

(defun pp/eshell-mode-hook ()
  "Eshell mode hook."
  (require 'eshell-z))

(use-package eshell-z :ensure t
  :hook (eshell-mode-hook . pp/eshell-mode-hook))

(defun eshell-new ()
  "Open a new instance of eshell."
  (interactive)
  (eshell 'N))

(use-package eshell-syntax-highlighting :ensure t
  :after esh-mode
  :config
  ;; Disable in all Eshell buffers by default.
  (eshell-syntax-highlighting-global-mode -1))
</pre>
</div>

<pre class="example">
  (eshell-syntax-highlighting-global-mode -1)

  (eshell-syntax-highlighting-global-mode +1)
</pre>
</div>

<div id="outline-container-orgb5e7e3a" class="outline-3">
<h3 id="orgb5e7e3a"><span class="section-number-3">35.1</span> How to open a file in emacs?</h3>
<div class="outline-text-3" id="text-35-1">
<p>
find-file &lt;filename&gt; =&gt; (find-file "&lt;filename&gt;")
</p>
</div>
</div>

<div id="outline-container-orge7d5b72" class="outline-3">
<h3 id="orge7d5b72"><span class="section-number-3">35.2</span> Setting environment variables</h3>
<div class="outline-text-3" id="text-35-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setenv "SNOWSQL_ACCOUNT" "some-value.eu-west-1")
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0025ab3" class="outline-2">
<h2 id="org0025ab3"><span class="section-number-2">36</span> restclient, major mode for sending HTTP requests</h2>
<div class="outline-text-2" id="text-36">
<p>
Although now I try to use Babashka instead.
</p>

<p>
Another alternative - Elisp package <a href="https://github.com/tkf/emacs-request">https://github.com/tkf/emacs-request</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package restclient :ensure t
  :mode (("\\.http\\'" . restclient-mode)))

(use-package ob-restclient :ensure t) ;; support in org-babel

;(load "restclient-jq") - haven't manage to make it working, using Clojure instead for dealing with JSON
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdfb440b" class="outline-2">
<h2 id="orgdfb440b"><span class="section-number-2">37</span> AnyBar, show circle indicator in macOS menu</h2>
<div class="outline-text-2" id="text-37">
<pre class="example">
(use-package anybar :ensure t)
</pre>
</div>
</div>

<div id="outline-container-orgcf36343" class="outline-2">
<h2 id="orgcf36343"><span class="section-number-2">38</span> DeadGrep - Searching in multiple files / project</h2>
<div class="outline-text-2" id="text-38">
<p>
grep / ripgrep / ag / ack / pt
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/deadgrep-view-file ()
  "View result under cursor in other window."
  (interactive)
  (deadgrep-visit-result-other-window)
  (other-window 1))

(use-package deadgrep :ensure t
  :bind (:map deadgrep-mode-map
              ("v" . pp/deadgrep-view-file)))
;; TODO: maybe setup next-error-follow-minor-mode as a hook?
</pre>
</div>
</div>

<div id="outline-container-org1cfe1cd" class="outline-3">
<h3 id="org1cfe1cd"><span class="section-number-3">38.1</span> Keybindings in Deadgrep buffer</h3>
<div class="outline-text-3" id="text-38-1">
<dl class="org-dl">
<dt><code>M-n</code>, <code>M-p</code></dt><dd>move to next/previous file</dd>
<dt><code>n</code>, <code>C-n</code>, <code>C-p</code></dt><dd>move to next/previous line</dd>
<dt><code>o</code></dt><dd>open matched file on matched line</dd>
<dt><code>v</code></dt><dd>view matched file on matched line (keeping focus in Deadgrep buffer)</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org048bfdd" class="outline-2">
<h2 id="org048bfdd"><span class="section-number-2">39</span> Formatting code</h2>
<div class="outline-text-2" id="text-39">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package format-all :ensure t)
</pre>
</div>
</div>

<div id="outline-container-org4dc9389" class="outline-3">
<h3 id="org4dc9389"><span class="section-number-3">39.1</span> Lispy - working with lisp s-expressions</h3>
<div class="outline-text-3" id="text-39-1">
<p>
Useful keybindings in Lispy:
</p>
<dl class="org-dl">
<dt><code>S</code>, <code>lispy-stringify</code></dt><dd>turn s-expr to string, useful fur turning JSON to string</dd>
<dt><code>C-u "</code>, <code>lispy-quotes</code></dt><dd>when inside quote string - unquote</dd>

<dt><code>C-8</code></dt><dd>lispy-parens-down</dd>

<dt><code>C-2</code>, <code>SPC-2</code>, <code>lispy-arglist-inline</code></dt><dd>C-2 doesn't work, so I bound it to <code>SPC-2</code></dd>

<dt><code>G</code>, =special-lispy-goto-local</dt><dd>go to local def</dd>
<dt><code>M</code>.=</dt><dd>go to symbol definition</dd>

<dt><code>d</code></dt><dd>go to other side of sexp</dd>

<dt><code>C-,</code></dt><dd>lispy-kill-at-point</dd>
<dt><code>m</code></dt><dd>mark current sexp, alternative to evil's <code>%</code></dd>
</dl>

<p>
Avy-based movements, work in a current sexp
</p>
<dl class="org-dl">
<dt><code>a</code></dt><dd>starts avy to go to symbol and mark it</dd>
<dt><code>H</code></dt><dd>starts avy to replace symbol</dd>
</dl>

<p>
<a href="https://github.com/r-darwish/.emacs.site.d/blob/8e565d29b50724dbe9cf973f4acd2faf526bccc5/config.el#L26">Example configuration with keybindings.</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/lispy-mode-hook ()
  "Turn on lispy, turn off evil-mode locally."
  (interactive)
  (lispy-mode 1))

(use-package lispy :ensure t
  :hook ((emacs-lisp-mode-hook . pp/lispy-mode-hook)
         (clojure-mode-hook . pp/lispy-mode-hook))
  :config (setq lispy-compat '(edebug cider)))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaea29c9" class="outline-3">
<h3 id="orgaea29c9"><span class="section-number-3">39.2</span> Dealing with pairs - smartparens</h3>
<div class="outline-text-3" id="text-39-2">
<p>
Turning off smartparens to not interact with lispy.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
;;(use-package smartparens :ensure t
;;  :diminish
;;  :config
;;    (smartparens-global-mode))

;; smartparens
;; "&lt;s-down&gt;" 'sp-down-sexp
;; "&lt;s-up&gt;" 'sp-up-sexp

</pre>
</div>
</div>
</div>

<div id="outline-container-orge847e76" class="outline-3">
<h3 id="orge847e76"><span class="section-number-3">39.3</span> <span class="todo TODO">TODO</span> Setup sql formatting</h3>
<div class="outline-text-3" id="text-39-3">
<p>
Mandatory:
</p>
<ul class="org-ul">
<li><code>format-all-buffer</code> should be able to invoke it</li>
<li>Need to process multiple SQL statements in a file</li>
<li>Static binary (go?), so no python dependencies</li>
<li>Good defaults</li>
</ul>

<p>
Nice to have:
</p>
<ul class="org-ul">
<li>Should understand templating (highly unlekely)</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgab5547f" class="outline-2">
<h2 id="orgab5547f"><span class="section-number-2">40</span> Colors in compilation buffers</h2>
<div class="outline-text-2" id="text-40">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(add-hook 'compilation-mode-hook 'ansi-color-for-comint-mode-on)
(add-to-list 'comint-output-filter-functions 'ansi-color-process-output)

(defun pp/colorize-buffer ()
  "Replace ANSI color sequences with actual colors in current buffer.
Source: https://lists.gnu.org/archive/html/help-gnu-emacs/2013-10/msg00229.html"
  (interactive)
  (read-only-mode -1)
  (ansi-color-apply-on-region (point-min) (point-max))
  (read-only-mode +1))

(add-hook 'compilation-filter-hook 'pp/colorize-buffer)


</pre>
</div>
</div>
</div>

<div id="outline-container-org11e9744" class="outline-2">
<h2 id="org11e9744"><span class="section-number-2">41</span> Language Server Protocol, LSP</h2>
<div class="outline-text-2" id="text-41">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package eglot :ensure t :commands eglot)

(use-package dumb-jump :ensure t)  ;; go to definition
</pre>
</div>
</div>
</div>

<div id="outline-container-orga93bc15" class="outline-2">
<h2 id="orga93bc15"><span class="section-number-2">42</span> Error checking</h2>
<div class="outline-text-2" id="text-42">
<p>
Two main packages providing minor mode for error checks:
</p>

<dl class="org-dl">
<dt>flymake</dt><dd>built-in into Emacs</dd>
<dt>flycheck</dt><dd>competitor that gained lots of popularity recently</dd>
</dl>
</div>

<div id="outline-container-org8260b36" class="outline-3">
<h3 id="org8260b36"><span class="section-number-3">42.1</span> Flymake</h3>
<div class="outline-text-3" id="text-42-1">
<p>
I found this configuration in <a href="https://github.com/turbo-cafe/flymake-kondor">flymake-kondor</a>'s README:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package flymake
  :hook (prog-mode . (lambda () (flymake-mode t)))
  :config (remove-hook 'flymake-diagnostic-functions #'flymake-proc-legacy-flymake))
</pre>
</div>
</div>
</div>

<div id="outline-container-org8a71145" class="outline-3">
<h3 id="org8a71145"><span class="section-number-3">42.2</span> Flycheck</h3>
<div class="outline-text-3" id="text-42-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;;(use-package flycheck
;;  :init (global-flycheck-mode))
;; (use-package flymake-easy)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org139c3a9" class="outline-2">
<h2 id="org139c3a9"><span class="section-number-2">43</span> Elisp</h2>
<div class="outline-text-2" id="text-43">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package rainbow-delimiters :ensure t
 ; :hook (prog-mode-hook . rainbow-delimiters-mode)
)

(show-paren-mode)

(use-package elisp-format :commands elisp-format-region)

(use-package paredit :ensure t
  :diminish)

(add-hook 'emacs-lisp-mode-hook 'flymake-mode)

</pre>
</div>

<dl class="org-dl">
<dt>Libraries for programming</dt><dd><a href="https://github.com/emacs-tw/awesome-emacs#programming">https://github.com/emacs-tw/awesome-emacs#programming</a></dd>
</dl>
</div>

<div id="outline-container-orgbf96eb4" class="outline-3">
<h3 id="orgbf96eb4"><span class="section-number-3">43.1</span> Dash - A modern list api for Emacs</h3>
<div class="outline-text-3" id="text-43-1">
<p>
<a href="https://github.com/magnars/dash.el">https://github.com/magnars/dash.el</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package dash :ensure t)
</pre>
</div>

<pre class="example">
(-map (lambda (n) (* n n)) '(1 2 3 4))
</pre>
</div>
</div>

<div id="outline-container-org1c97333" class="outline-3">
<h3 id="org1c97333"><span class="section-number-3">43.2</span> S - working with strings</h3>
<div class="outline-text-3" id="text-43-2">
<p>
<a href="https://github.com/magnars/s.el">https://github.com/magnars/s.el</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package s :ensure t)
</pre>
</div>

<pre class="example">
(s-join "," '("asdf" "qwer" "fdsa"))

(s-split-words "fooBar")
</pre>
</div>
</div>

<div id="outline-container-org63a5ea7" class="outline-3">
<h3 id="org63a5ea7"><span class="section-number-3">43.3</span> HT - working with HashTables</h3>
<div class="outline-text-3" id="text-43-3">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-05 Tue&gt;</span></span>
</p>


<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package ht :ensure t)
</pre>
</div>

<pre class="example">
(let ((example (ht ("Foo" "Bar")
                   ("a" "b"))))
  (s-join "&amp;" (-map (lambda (kv) (s-join "=" kv))
                    (ht-items example))))
</pre>
</div>
</div>

<div id="outline-container-orgdbd04ab" class="outline-3">
<h3 id="orgdbd04ab"><span class="section-number-3">43.4</span> Example using Elisp</h3>
<div class="outline-text-3" id="text-43-4">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-05 Tue&gt;</span></span>
</p>

<pre class="example">

(json-encode
 (list :requests
  (let ((params (list (ht ("hitsPerPage" "1")
                            ("filters" "origin:IND AND anchorId:place-432123"))
                        (ht ("hitsPerPage" "1")
                            ("filters" "visitorId:pavel"))
                        (ht ("hitsPerPage" "1")
                            ("filters" "userAgent:googlebot"))))
        (req (lambda (p)
               (ht (:indexName "prod_banapi_v1")
                   (:params (url-hexify-string
                             (s-join "&amp;" (-map (lambda (kv) (s-join "=" kv))
                                               (ht-items p)))))))))
    (-map req params))))


(object :foo :bar)

(json-encode (ht (:hitsPerPage "1")
                 (:filters "userAgent:googlebot")))


(json-serialize '(:foo 1 :qwer 2))

(json-encode '(:requests (list 1 2 3 4)))

(json-encode '(:requests (list ) :foo :bar (3 4)))


(let* ((plus-one (lambda (n) (+ n 1)))
       (plus-two (lambda (x) (funcall plus-one (funcall plus-one x)))))
  (funcall plus-two 3))


(lexical-let*
    ((plus-one (lambda (n) (+ n 1)))
     (plus-two (lambda (x) (plus-one (plus-one x)))))
  (plus-two 3))


(let* ((y 1)
      (z y))
  (list y z))


(json-encode
 (list :requests
  (let ((params (list (ht (:hitsPerPage "1")
                          (:filters "origin:IND AND anchorId:hotel-12346"))
                      (ht (:hitsPerPage "1")
                          (:filters "visitorId:pasha"))))
        (req (lambda (p)
               (ht (:indexName "prod_banapi_v1")
                   (:params (url-encode-url
                             (s-join "&amp;" (-map (lambda (kv) (s-join "=" kv))
                                               (ht-items p)))))))))
    (-map req params))))


(ht (:foo :bar)
    (:fo1 :bar)
    (:fo2 :bar)
    (:fo3 :bar))


</pre>
</div>
</div>
</div>
<div id="outline-container-orgd7f599b" class="outline-2">
<h2 id="orgd7f599b"><span class="section-number-2">44</span> Golang</h2>
<div class="outline-text-2" id="text-44">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/go-mode-hook ()
  "Hook for 'go-mode'."
  (add-hook 'before-save-hook 'gofmt-before-save)
  (setq
     tab-width 4
     indent-tabs-mode 1)
  ;; (flymake-mode)
  (general-define-key
     :states '(normal)
     :prefix "g"
     "d" 'xref-find-definitions
     "h" 'godoc-at-point))

(use-package go-mode
  :config
  (setq-default
    gofmt-command "goimports"
    ;; gofmt-args (list "-s")
    )
  :hook (go-mode-hook . pp/go-mode-hook))

(use-package gotest :ensure t
  :config
  (setq-default go-test-args "-timeout 2s"))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5201b6a" class="outline-2">
<h2 id="org5201b6a"><span class="section-number-2">45</span> Terraform</h2>
<div class="outline-text-2" id="text-45">
<p>
Since somewhere in November 2020 resource names started showing in
pink, which I can't distinguish on any background, so I change it to
be the same as resource type.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package terraform-mode :ensure t
  :config (setq terraform--resource-name-face 'terraform--resource-type-face)
  :hook (terraform-mode-hook . terraform-format-on-save-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org8f61056" class="outline-2">
<h2 id="org8f61056"><span class="section-number-2">46</span> JSON</h2>
<div class="outline-text-2" id="text-46">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/json-mode-hook ()
  (setq
     tab-width 2
     js-indent-level 2
     indent-tabs-mode nil))

(use-package json-mode :ensure t
  :hook (json-mode-hook . pp/json-mode-hook))
</pre>
</div>

<p>
Related:
</p>
<ul class="org-ul">
<li><a href="https://github.com/p-baleine/jq.el">https://github.com/p-baleine/jq.el</a></li>
</ul>
</div>

<div id="outline-container-org57922ee" class="outline-3">
<h3 id="org57922ee"><span class="section-number-3">46.1</span> Validating if JSON is valid</h3>
<div class="outline-text-3" id="text-46-1">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-12 Tue&gt;</span></span>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/selection-valid-json? (beg end)
  "Validates selection from BEG to END to be a valid JSON."
  (interactive "r")
  (json-read-from-string (buffer-substring-no-properties beg end)))
</pre>
</div>

<pre class="example">
(json-read-from-string "{\"a\": 1}")
</pre>
</div>
</div>
<div id="outline-container-org04f2199" class="outline-3">
<h3 id="org04f2199"><span class="section-number-3">46.2</span> <span class="todo TODO">TODO</span> Try json-pointer</h3>
<div class="outline-text-3" id="text-46-2">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-05 Tue&gt;</span></span>
<a href="https://github.com/syohex/emacs-json-pointer">https://github.com/syohex/emacs-json-pointer</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org0f57f3e" class="outline-2">
<h2 id="org0f57f3e"><span class="section-number-2">47</span> YAML</h2>
<div class="outline-text-2" id="text-47">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package yaml-mode :ensure t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org25bd77b" class="outline-2">
<h2 id="org25bd77b"><span class="section-number-2">48</span> Ledger, double-entry plain text accounting system</h2>
<div class="outline-text-2" id="text-48">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;(use-package ledger-mode :ensure t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orge3151c5" class="outline-2">
<h2 id="orge3151c5"><span class="section-number-2">49</span> Clojure</h2>
<div class="outline-text-2" id="text-49">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package clojure-mode :ensure t
  :config
  (setq clojure-align-forms-automatically t))

(require 'ob-clojure) ;; enable clojure in org-babel
</pre>
</div>
</div>

<div id="outline-container-orgb0881e1" class="outline-3">
<h3 id="orgb0881e1"><span class="section-number-3">49.1</span> How to develop in Clojure (CIDER)</h3>
<div class="outline-text-3" id="text-49-1">
<p>
CIDER Docs: <a href="https://docs.cider.mx/cider/index.html">https://docs.cider.mx/cider/index.html</a>
</p>

<dl class="org-dl">
<dt><code>cider-eval-defun-at-point</code> (<code>C-c C-c</code>)</dt><dd>on S-exp will evaluate
outer S-exp, both in Evil Normal and Insert modes</dd>

<dt><code>cider-eval-last-sexp</code> (<code>C-c C-e</code>)</dt><dd>having cursor after S-exp will
evaluate previous one, sometimes doesn't work as expected in Evil
Normal mode, use Insert mode instead</dd>

<dt><code>cider-clojuredocs</code> (<code>C-c C-d C-c</code>)</dt><dd>open documentation from
ClojureDocs. Default search term is that under cursor</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package cider :ensure t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org58f1b52" class="outline-3">
<h3 id="org58f1b52"><span class="section-number-3">49.2</span> inf-clojure</h3>
<div class="outline-text-3" id="text-49-2">
<p>
<a href="https://github.com/clojure-emacs/inf-clojure">https://github.com/clojure-emacs/inf-clojure</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package inf-clojure :ensure t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgba5bf86" class="outline-3">
<h3 id="orgba5bf86"><span class="section-number-3">49.3</span> Useful helper functions</h3>
<div class="outline-text-3" id="text-49-3">
<div class="org-src-container">
<pre class="src src-clojure">;; change current namespace
(in-ns 'hello.cruel-world)

(filter #(clojure.string/includes? % "json")
        (map str (all-ns)))

(filter #(and
          (not (clojure.string/includes? % "cider"))
          (not (clojure.string/includes? % "nrepl"))
          (not (clojure.string/includes? % "clojure")))
        (map str (all-ns)))

(filter #(complement (or (map
clojure.string/includes? ["cider" "nrepl" "clojure"]))
        (map str (all-ns)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfa41ef0" class="outline-3">
<h3 id="orgfa41ef0"><span class="section-number-3">49.4</span> Linter - clj-kondo</h3>
<div class="outline-text-3" id="text-49-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package flymake-quickdef :ensure t)

(use-package flymake-kondor :ensure t
  :hook (clojure-mode-hook . flymake-kondor-setup))
</pre>
</div>

<pre class="example">
(executable-find "clj-kondo")
</pre>
</div>
</div>

<div id="outline-container-org180af72" class="outline-3">
<h3 id="org180af72"><span class="section-number-3">49.5</span> ClojureScript</h3>
<div class="outline-text-3" id="text-49-5">
</div>
<div id="outline-container-orgc52253f" class="outline-4">
<h4 id="orgc52253f"><span class="section-number-4">49.5.1</span> <span class="todo TODO">TODO</span> Try re-jump for re-frame</h4>
<div class="outline-text-4" id="text-49-5-1">
<p>
<a href="https://github.com/oliyh/re-jump.el/blob/master/re-jump.el">https://github.com/oliyh/re-jump.el/blob/master/re-jump.el</a>
</p>
</div>
</div>
</div>
<div id="outline-container-org39ee796" class="outline-3">
<h3 id="org39ee796"><span class="section-number-3">49.6</span> 4Clojure</h3>
<div class="outline-text-3" id="text-49-6">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-23 Wed&gt; </span></span> <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-11-28 Sat&gt;</span></span>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package 4clojure :ensure t)

(defun endless/4clojure-check-and-proceed ()
  "Check the answer and show the next question if it worked."
  (interactive)
  (unless
      (save-excursion
        ;; Find last sexp (the answer).
        (goto-char (point-max))
        (forward-sexp -1)
        ;; Check the answer.
        (cl-letf ((answer
                   (buffer-substring (point) (point-max)))
                  ;; Preserve buffer contents, in case you failed.
                  ((buffer-string)))
          (goto-char (point-min))
          (while (search-forward "__" nil t)
            (replace-match answer))
          (string-match "failed." (4clojure-check-answers))))
    (4clojure-next-question)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5830ccd" class="outline-2">
<h2 id="org5830ccd"><span class="section-number-2">50</span> JavaScript</h2>
<div class="outline-text-2" id="text-50">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/js-mode-hook ()
  "Hook for 'js-mode'."
  (setq
     tab-width 2
     indent-tabs-mode nil)
  (flymake-mode))

(use-package js-mode
  :hook (js-mode-hook . pp/js-mode-hook)
  :config
  (setq js-indent-level 2))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2cb1fe4" class="outline-2">
<h2 id="org2cb1fe4"><span class="section-number-2">51</span> TypeScript</h2>
<div class="outline-text-2" id="text-51">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package typescript-mode :ensure t
  :config
  (setq typescript-indent-level 2))

(use-package tide :ensure t
  :config
  (setq tide-format-options
        (list :insertSpaceAfterFunctionKeywordForAnonymousFunctions t
              :placeOpenBraceOnNewLineForFunctions nil)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9a1088c" class="outline-2">
<h2 id="org9a1088c"><span class="section-number-2">52</span> Scala</h2>
<div class="outline-text-2" id="text-52">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/scala-mode-hook ()
  "Hook for 'scala-mode'."
  (general-define-key :states '(normal) :prefix "g"
    "h" 'eglot-help-at-point))

(use-package scala-mode
  :mode "\\.s\\(cala\\|bt\\)$"
  :hook (scala-mode-hook . pp/scala-mode-hook))

;; Enable sbt mode for executing sbt commands
(use-package sbt-mode
  :commands (sbt-start sbt-command)
  :config
  ;; WORKAROUND: https://github.com/ensime/emacs-sbt-mode/issues/31
  ;; allows using SPACE when in the minibuffer
  (substitute-key-definition
   'minibuffer-complete-word
   'self-insert-command
   minibuffer-local-completion-map)
   ;; sbt-supershell kills sbt-mode:  https://github.com/hvesalai/emacs-sbt-mode/issues/152
   (setq sbt:program-options '("-Dsbt.supershell=false")))


</pre>
</div>
</div>
</div>

<div id="outline-container-org677d1c4" class="outline-2">
<h2 id="org677d1c4"><span class="section-number-2">53</span> Highlighting</h2>
<div class="outline-text-2" id="text-53">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(defun pp/highlight-symbol-hook ()
  "Hook for highlighting symbols."
  (highlight-symbol-nav-mode)
  (highlight-symbol "TODO:"))

(use-package highlight-symbol :ensure t
  :hook ((prog-mode-hook . pp/highlight-symbol-hook)
         (text-mode-hook . pp/highlight-symbol-hook)
         (org-mode-hook . pp/highlight-symbol-hook))
  :config
  (setq
     highlight-symbol-colors
       (quote
         ("light goldenrod" "deep sky blue" "light coral" "chocolate" "orange" "red" "orange red"))
     highlight-symbol-foreground-color "black"))
</pre>
</div>
</div>

<div id="outline-container-orgbd1b829" class="outline-3">
<h3 id="orgbd1b829"><span class="section-number-3">53.1</span> Color identifiers mode</h3>
<div class="outline-text-3" id="text-53-1">
<p>
Don't remember what's this.
</p>

<pre class="example">
(use-package color-identifiers-mode :ensure t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc27f04a" class="outline-2">
<h2 id="orgc27f04a"><span class="section-number-2">54</span> Random helper functions</h2>
<div class="outline-text-2" id="text-54">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/switch-to-scratch-buffer ()
  "Switch to *scratch* buffer."
  (interactive)
  (switch-to-buffer "*scratch*"))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2accd5a" class="outline-2">
<h2 id="org2accd5a"><span class="section-number-2">55</span> Network utilities in Emacs</h2>
<div class="outline-text-2" id="text-55">
<pre class="example">

(telnet "ya.ru" 80)

(ping "ya.ru")

(telnet "inbucket.nyancat.gcp.in-gr.ru" 443)

</pre>
</div>
</div>
<div id="outline-container-org787d761" class="outline-2">
<h2 id="org787d761"><span class="section-number-2">56</span> Open browser from Emacs</h2>
<div class="outline-text-2" id="text-56">
<pre class="example">
(start-process "" nil "open" "http://clojure.org")

(xwidget-webkit-browse-url "http://clojure.org")
</pre>
</div>
</div>
<div id="outline-container-orgcd96892" class="outline-2">
<h2 id="orgcd96892"><span class="section-number-2">57</span> Blogging</h2>
<div class="outline-text-2" id="text-57">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-27 Sun&gt;</span></span>
</p>

<p>
How to run a blog from Emacs with minimum overhead efforts.
</p>

<p>
Check ./How-do-I-blog.org file for details.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/export-to-blog ()
  "Converts current Org buffer to html and moves it to blog sources folder."
  (interactive)
  (let ((filename (org-html-export-to-html)))
    (rename-file filename "~/Documents/Projects/pavel-popov.github.io/" t)))
</pre>
</div>
</div>
<div id="outline-container-org9fc9777" class="outline-3">
<h3 id="org9fc9777"><span class="section-number-3">57.1</span> Deft - a package for dealing with text notes</h3>
<div class="outline-text-3" id="text-57-1">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-11-22 Sun&gt;</span></span>
</p>

<p>
Similar to ideas of Notational Velocity (and Wiki) to have a plain
list of notes allowing quickly filtering and searching for them.
</p>

<p>
However, there are some caveats of using Deft:
</p>

<ul class="org-ul">
<li><code>deft-auto-save-interval</code> is by default set to 1, which triggers
autosaving the current buffer every 1 second. Since I also have
removing trailing whitespaces on save enabled, that setting were
actually preventing from writing any text, cutting spaces.
Setting it to 0 solves the problem, really insane default value.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package deft :ensure t
  :config
  (setq
   deft-auto-save-interval 0
   deft-extensions '("org")
   deft-default-extension "org"
   deft-use-filename-as-title nil
   deft-use-filter-string-for-filename t
   deft-org-mode-title-prefix t
   deft-file-naming-rules
   '((noslash . "-")
     (nospace . "-")
     (case-fn . capitalize))
   deft-directory "/Users/pavel/Documents/Projects/Blog"))
</pre>
</div>

<p>
When creating a new file using <code>deft-new-file</code> and above configuration
it uses deft filter value for the title and filename. The problem is
that I rarely use Deft' filtering, but instead use <code>C-s</code> to run
Swiper. So, here is a custom function for creating a new note, which
prompts for a string, sets Deft filter to it and creates new file in
Deft directory.
</p>


<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/deft-new-file (title)
  "Create new note with provided TITLE using Deft."
  (interactive "sTitle for a new note: ")
  (deft-filter title t)
  (deft-new-file))
</pre>
</div>
</div>

<div id="outline-container-org2da209d" class="outline-4">
<h4 id="org2da209d"><span class="section-number-4">57.1.1</span> NotDeft</h4>
<div class="outline-text-4" id="text-57-1-1">
<p>
Spin-off of Deft for searching in a set of folders and use Deft-inspired UI.
</p>

<p>
<a href="https://tero.hasu.is/notdeft/">https://tero.hasu.is/notdeft/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org3c36e34" class="outline-3">
<h3 id="org3c36e34"><span class="section-number-3">57.2</span> Smart Notes / Slip-Box / ZettelKasten</h3>
<div class="outline-text-3" id="text-57-2">
<p>
That topic gained lots of popularity in Summer 2020, including several
posts on HN and Reddit, in particular ZettelDeft package that uses
Deft as file manager and creates backlinks between notes. I tried to
use it and found too complicated for my needs, so decided not use it
for now.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; (use-package zetteldeft
;;   :after deft
;;   :config
;;     (zetteldeft-set-classic-keybindings))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org1dcfa1f" class="outline-2">
<h2 id="org1dcfa1f"><span class="section-number-2">58</span> Recording video</h2>
<div class="outline-text-2" id="text-58">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-22 Tue&gt;</span></span>
<a href="https://macreports.com/record-face-screen-mac/">https://macreports.com/record-face-screen-mac/</a>
</p>
</div>
</div>

<div id="outline-container-org2803d7a" class="outline-2">
<h2 id="org2803d7a"><span class="section-number-2">59</span> Jet - transforms between JSON, EDN and Transit&#xa0;&#xa0;&#xa0;<span class="tag"><span class="json">json</span>&#xa0;<span class="edn">edn</span>&#xa0;<span class="clojure">clojure</span>&#xa0;<span class="clj">clj</span></span></h2>
<div class="outline-text-2" id="text-59">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-21 Mon&gt;</span></span>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/jet-edn-prettify ()
  "Prettyfy selection of buffer using jet."
  (interactive)
  (shell-command-on-region
   (region-beginning)
   (region-end)
   "jet --pretty --edn-reader-opts '{:default tagged-literal}'"
   (current-buffer)
   t
   "*jet error buffer*"
   t))

(defun pp/jet-edn-to-json ()
  "Prettyfy selection of buffer using jet."
  (interactive)
  (shell-command-on-region
   (region-beginning)
   (region-end)
   "jet --pretty --from edn --to json"
   (current-buffer)
   t
   "*jet error buffer*"
   t))

(defun pp/jet-json-to-edn ()
  "Prettyfy selection of buffer using jet."
  (interactive)
  (shell-command-on-region
   (region-beginning)
   (region-end)
   "jet --pretty --from json --to edn --keywordize '#((if (str/includes? % \" \") str keyword) %)'"
   (current-buffer)
   t
   "*jet error buffer*"
   t))
</pre>
</div>
</div>
</div>
<div id="outline-container-org6657956" class="outline-2">
<h2 id="org6657956"><span class="section-number-2">60</span> Command log mode - record keystrokes</h2>
<div class="outline-text-2" id="text-60">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-22 Tue&gt;</span></span>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package command-log-mode :ensure t)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf445209" class="outline-2">
<h2 id="orgf445209"><span class="section-number-2">61</span> Collaborative editing, Floobits, Live Share</h2>
<div class="outline-text-2" id="text-61">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package floobits :ensure t)
</pre>
</div>
</div>
</div>
<div id="outline-container-orga9affcb" class="outline-2">
<h2 id="orga9affcb"><span class="section-number-2">62</span> Packages to try someday</h2>
<div class="outline-text-2" id="text-62">
<dl class="org-dl">
<dt>Productivity tips</dt><dd><a href="https://news.ycombinator.com/item?id=22129636">https://news.ycombinator.com/item?id=22129636</a></dd>
<dt>Literate Devops</dt><dd><a href="http://howardism.org/Technical/Emacs/literate-devops.html">http://howardism.org/Technical/Emacs/literate-devops.html</a>
Discussion: <a href="https://news.ycombinator.com/item?id=16559004">https://news.ycombinator.com/item?id=16559004</a></dd>
<dt>Purpose</dt><dd>Manage Windows and Buffers According to Purposes
<a href="https://github.com/bmag/emacs-purpose">https://github.com/bmag/emacs-purpose</a></dd>
</dl>
</div>
</div>
<div id="outline-container-orgcff5899" class="outline-2">
<h2 id="orgcff5899"><span class="section-number-2">63</span> Trying packages</h2>
<div class="outline-text-2" id="text-63">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package try :ensure t)
</pre>
</div>
</div>
</div>
<div id="outline-container-org48baf75" class="outline-2">
<h2 id="org48baf75"><span class="section-number-2">64</span> Reading from s3 using <code>sqlc</code> tool</h2>
<div class="outline-text-2" id="text-64">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-11-18 Wed&gt;</span></span>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun pp/sqlc (url)
  "Run sql command with provided URL and other options."
  (interactive "sURL for sqlc: ")
  (let* ((out-buffer-name (first (split-string url)))
         (err-buffer-name "*sqlc errors*")
         (out-buffer (get-buffer-create out-buffer-name))
         (err-buffer (get-buffer-create err-buffer-name)))
    (with-current-buffer out-buffer (erase-buffer))
    (with-current-buffer err-buffer (erase-buffer))
    (shell-command (format "sqlc -f %s" url) out-buffer err-buffer-name)))
</pre>
</div>
</div>
</div>
<div id="outline-container-org9549bfa" class="outline-2">
<h2 id="org9549bfa"><span class="section-number-2">65</span> <span class="todo TODO">TODO</span> Typing response</h2>
<div class="outline-text-2" id="text-65">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-11-22 Sun&gt; </span></span> <span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-13 Wed&gt;</span></span>
</p>

<p>
Sometimes I feel that typing feedback in Emacs is really slow, like
visually noticable lag when I press the button and a character appears
on the screen.
</p>

<p>
It is particularly noticable when opened on 27" display. Turning from
Org-mode to Fundamental mode doesn't make huge difference.
</p>
</div>
</div>

<div id="outline-container-org1636832" class="outline-2">
<h2 id="org1636832"><span class="section-number-2">66</span> Emacs-webkit - using Safari from Emacs</h2>
<div class="outline-text-2" id="text-66">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-11-22 Sun&gt;</span></span>
</p>

<p>
<a href="https://www.reddit.com/r/emacs/comments/jyowe0/introducing_emacswebkit_a_successor_to/">Announcement on Reddit</a>
</p>

<blockquote>
<p>
emacs-webkit requires at least Emacs 28
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org3122e18" class="outline-2">
<h2 id="org3122e18"><span class="section-number-2">67</span> <span class="todo TODO">TODO</span> How to explicitly record the mental stack?</h2>
<div class="outline-text-2" id="text-67">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-11-22 Sun&gt;</span></span>
<a href="https://www.reddit.com/r/emacs/comments/jxvm1h/how_to_explicitly_record_the_mental_stack/">https://www.reddit.com/r/emacs/comments/jxvm1h/how_to_explicitly_record_the_mental_stack/</a>
</p>
</div>
</div>
<div id="outline-container-org9df38b1" class="outline-2">
<h2 id="org9df38b1"><span class="section-number-2">68</span> Xah Lee's functions</h2>
<div class="outline-text-2" id="text-68">
</div>
<div id="outline-container-orgfd89cdf" class="outline-3">
<h3 id="orgfd89cdf"><span class="section-number-3">68.1</span> Opening file in External App</h3>
<div class="outline-text-3" id="text-68-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun xah-open-in-external-app (&amp;optional @fname)
  "Open the current file or dired marked files in external app.
The app is chosen from your OS's preference.

When called in emacs lisp, if @fname is given, open that.

URL `http://ergoemacs.org/emacs/emacs_dired_open_file_in_ext_apps.html'
Version 2019-11-04"
  (interactive)
  (let* (
         ($file-list
          (if @fname
              (progn (list @fname))
            (if (string-equal major-mode "dired-mode")
                (dired-get-marked-files)
              (list (buffer-file-name)))))
         ($do-it-p (if (&lt;= (length $file-list) 5)
                       t
                     (y-or-n-p "Open more than 5 files? "))))
    (when $do-it-p
      (cond
       ((string-equal system-type "windows-nt")
        (mapc
         (lambda ($fpath)
           (w32-shell-execute "open" $fpath)) $file-list))
       ((string-equal system-type "darwin")
        (mapc
         (lambda ($fpath)
           (shell-command
            (concat "open " (shell-quote-argument $fpath))))  $file-list))
       ((string-equal system-type "gnu/linux")
        (mapc
         (lambda ($fpath) (let ((process-connection-type nil))
                            (start-process "" nil "xdg-open" $fpath))) $file-list))))))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org287ef9f" class="outline-2">
<h2 id="org287ef9f"><span class="section-number-2">69</span> PlantUML for creating diagrams</h2>
<div class="outline-text-2" id="text-69">
<p>
Link: <a href="https://github.com/skuro/plantuml-mode">https://github.com/skuro/plantuml-mode</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package plantuml-mode :ensure t
  :config
  (setq org-plantuml-jar-path "/usr/local/lib/plantuml.jar"
        plantuml-default-exec-mode 'jar)
  (org-display-inline-images))
</pre>
</div>
</div>

<div id="outline-container-orgd473b15" class="outline-3">
<h3 id="orgd473b15"><span class="section-number-3">69.1</span> Examples</h3>
<div class="outline-text-3" id="text-69-1">
</div>
<div id="outline-container-orgc3be250" class="outline-4">
<h4 id="orgc3be250"><span class="section-number-4">69.1.1</span> Sequence diagram</h4>
<div class="outline-text-4" id="text-69-1-1">
<pre class="example">
Bob -&gt;x Alice
Bob -&gt; Alice
Bob -&gt;&gt; Alice
Bob -\ Alice
Bob \\- Alice
Bob //-- Alice

Bob -&gt;o Alice
Bob o\\-- Alice

Bob &lt;-&gt; Alice
Bob &lt;-&gt;o Alice


Alice -&gt; Bob: Authentication Request

alt successful case

    Bob -&gt; Alice: Authentication Accepted

else some kind of failure

    Bob -&gt; Alice: Authentication Failure
    group My own label
    Alice -&gt; Log : Log attack start
        loop 1000 times
            Alice -&gt; Bob: DNS Attack
        end
    Alice -&gt; Log : Log attack end
    end

else Another type of failure

   Bob -&gt; Alice: Please repeat

end

Alice-&gt;Bob : hello
note left: this is a first note

Bob-&gt;Alice : ok
note right: this is another note

Bob-&gt;Bob : I am thinking
note left
a note
can also be defined
on several lines
end note


Alice -&gt; Bob: Authentication Request
...
Bob --&gt; Alice: Authentication Response
...5 minutes later...
Bob --&gt; Alice: Good Bye !

</pre>


<div class="figure">
<p><img src="sample-sequence.png" alt="sample-sequence.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org55a3750" class="outline-4">
<h4 id="org55a3750"><span class="section-number-4">69.1.2</span> JSON</h4>
<div class="outline-text-4" id="text-69-1-2">
<pre class="example">
@startjson
{
  "firstName": "John",
  "lastName": "Smith",
  "isAlive": true,
  "age": 27,
  "address": {
    "streetAddress": "21 2nd Street",
    "city": "New York",
    "state": "NY",
    "postalCode": "10021-3100"
  },
  "phoneNumbers": [
    {
      "type": "home",
      "number": "212 555-1234"
    },
    {
      "type": "office",
      "number": "646 555-4567"
    }
  ],
  "children": [],
  "spouse": null
}
@endjson
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org94779ba" class="outline-2">
<h2 id="org94779ba"><span class="section-number-2">70</span> Convert text into Slack's Alphabet Emojis</h2>
<div class="outline-text-2" id="text-70">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-12-09 Wed&gt;</span></span>
</p>

<p>
Slack recently released alphabet emojis, meaning we can start writing
text using them! What a nice idea!
</p>

<p>
And Emacs will help us with that, so having a function which takes
plain text and converts it to emojis.
</p>

<p>
Let's write it:
</p>


<div class="org-src-container">
<pre class="src src-emacs-lisp">
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd3099fd" class="outline-2">
<h2 id="orgd3099fd"><span class="section-number-2">71</span> Autoremove asked to delete 15 packages that I use</h2>
<div class="outline-text-2" id="text-71">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-12-12 Sat&gt;</span></span>
</p>

<blockquote>
<p>
Packages to delete: 15 (xref tide rainbow-mode rainbow-delimiters
project popup paredit flymake flycheck eldoc eglot dumb-jump
dired-single company color-identifiers-mode), proceed? (y or n) n
</p>

<p>
Package ‘xref-1.0.4’ deleted.
Package ‘tide-20201031.539’ deleted.
Package ‘rainbow-mode-1.0.5’ deleted.
Package ‘rainbow-delimiters-20200827.321’ deleted.
Package ‘project-0.5.2’ deleted.
Package ‘popup-20200610.317’ deleted.
Package ‘paredit-20191121.2328’ deleted.
Package ‘flymake-1.0.9’ deleted.
Package ‘flycheck-20201105.423’ deleted.
Package ‘eldoc-1.11.0’ deleted.
Package ‘eglot-20201103.1026’ deleted.
Package ‘dumb-jump-20201205.1625’ deleted.
Package ‘dired-single-20200824.708’ deleted.
Package ‘company-20201120.1115’ deleted.
Package ‘color-identifiers-mode-20201029.2325’ deleted.
</p>
</blockquote>

<p>
Let's see if I actually need those after I remove.
</p>
</div>
</div>
<div id="outline-container-orgea3d8a0" class="outline-2">
<h2 id="orgea3d8a0"><span class="section-number-2">72</span> Mini frame - display minibuffer at the center of the screen</h2>
<div class="outline-text-2" id="text-72">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-12-12 Sat&gt;</span></span>
</p>

<p>
I disabled it temporary due to switch from Ivy+Swiper+Counsel to
Selectrum+Consult.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package mini-frame :ensure t
  :config
  (setq mini-frame-show-parameters
        '((left . 0.5)
          (top . 0.3)
          (width . 0.75)))
  ;;(add-to-list 'mini-frame-ignore-commands 'swiper-isearch)
  (mini-frame-mode -1))
</pre>
</div>
</div>
</div>
<div id="outline-container-org2e98813" class="outline-2">
<h2 id="org2e98813"><span class="section-number-2">73</span> Vega - visualisation grammar</h2>
<div class="outline-text-2" id="text-73">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-12-13 Sun&gt;</span></span>
</p>

<p>
<a href="https://github.com/applied-science/emacs-vega-view">https://github.com/applied-science/emacs-vega-view</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package vega-view :ensure t)
</pre>
</div>
</div>
</div>
<div id="outline-container-org1d3e66e" class="outline-2">
<h2 id="org1d3e66e"><span class="section-number-2">74</span> Prism.el - highlight code by depth</h2>
<div class="outline-text-2" id="text-74">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2020-12-28 Mon&gt;</span></span>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package prism :ensure t
  :straight (prism :type git :host github :repo "alphapapa/prism.el")
  :hook (prog-mode-hook . prism-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-org69dcdc6" class="outline-2">
<h2 id="org69dcdc6"><span class="section-number-2">75</span> Emacs NES emulator</h2>
<div class="outline-text-2" id="text-75">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-08 Fri&gt;</span></span>
Didn't end having it set up because of reviews from
the author saying it's painfully slow.
</p>
<pre class="example">
(add-to-list 'load-path "~/.emacs.d/packages/emacs-nes")
(load-library 'nes)
</pre>
</div>
</div>
<div id="outline-container-org97121d9" class="outline-2">
<h2 id="org97121d9"><span class="section-number-2">76</span> Working with S3</h2>
<div class="outline-text-2" id="text-76">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-15 Fri&gt;</span></span>
</p>

<p>
I found <code>s3ed</code> mode - <a href="https://github.com/mattusifer/s3ed">https://github.com/mattusifer/s3ed</a>.
</p>

<pre class="example">
(try-and-refresh 's3ed)
(s3ed-mode)
(s3ed-find-file)
</pre>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package s3ed :ensure t
  :commands s3ed-find-file
  :config (s3ed-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-org29906ec" class="outline-2">
<h2 id="org29906ec"><span class="section-number-2">77</span> TRAMP</h2>
<div class="outline-text-2" id="text-77">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-16 Sat&gt;</span></span>
</p>

<p>
The method part of remote file names is mandatory now.
A valid remote file name starts with "/method:host:" or
"/method:user@host:".
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq tramp-default-method "ssh")
</pre>
</div>
</div>
</div>
<div id="outline-container-org5a7126f" class="outline-2">
<h2 id="org5a7126f"><span class="section-number-2">78</span> Finda</h2>
<div class="outline-text-2" id="text-78">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-19 Tue&gt;</span></span>
</p>

<p>
<a href="https://keminglabs.com/finda/setup/">https://keminglabs.com/finda/setup/</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(load "~/.finda/integrations/emacs/finda.el")
</pre>
</div>
</div>
</div>
<div id="outline-container-org8d76ec9" class="outline-2">
<h2 id="org8d76ec9"><span class="section-number-2">79</span> Testing how built-in calc works with Babel</h2>
<div class="outline-text-2" id="text-79">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-01-26 Tue&gt;</span></span>
</p>

<p>
Documentation:
<a href="https://www.gnu.org/software/emacs/manual/html_mono/calc.html">https://www.gnu.org/software/emacs/manual/html_mono/calc.html</a>
</p>

<div class="org-src-container">
<pre class="src src-calc">fsolve(x*2+x=4,x)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-calc">30*1024*1024
</pre>
</div>

<div class="org-src-container">
<pre class="src src-calc">date(&lt;Sun Aug 11, 2013&gt;)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-calc">unixtime(1498640400)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-calc">x + y
</pre>
</div>

<div class="org-src-container">
<pre class="src src-calc">6918 * 12
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbe17dd0" class="outline-2">
<h2 id="orgbe17dd0"><span class="section-number-2">80</span> Toggle function</h2>
<div class="outline-text-2" id="text-80">
<p>
Link: <a href="https://www.reddit.com/r/emacs/comments/l4v1ux/one_of_the_most_useful_small_lisp_functions_in_my/">One of the most useful small lisp functions in my config</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq lexical-binding t)

(defun make-toggle-function (buffer-name buffer-create-fn &amp;optional switch-cont)
  "Makes a toggle-function to have raise-or-create behaviour.

Creates a toggle-function that executes BUFFER-CREATE-FN if a
buffer named BUFFER-NAME doesn't exist, switches to the buffer
named BUFFER-NAME if it exists, and switches to the previous
buffer if we are currently visiting buffer BUFFER-NAME.

The SWITCH-CONT argument is a function which, if given, is called
after the buffer has been created or switched to.  This allows
running further actions that setup the state of the buffer or
modify it."
  (lambda ()
    (interactive)
    (let ((target-buf (get-buffer buffer-name)))
     (if target-buf
	 (if (eq (current-buffer) target-buf)
	     (progn
	       (message "switching to other buffer")
	       (switch-to-buffer nil))
	     (progn
	       (message "switching back...")
	       (switch-to-buffer buffer-name)
	       (when switch-cont (funcall switch-cont))))
       (message "creating buffer...")
       (funcall buffer-create-fn)
       (when switch-cont (funcall switch-cont))))))

(global-set-key (kbd "C-h SPC") (make-toggle-function "*scratch*" (lambda ())))
</pre>
</div>

<pre class="example">
(funcall ((lambda (arg1) (lambda () (message "foo: %s" arg1))) "bar"))
</pre>
</div>
</div>

<div id="outline-container-orgb945e4b" class="outline-2">
<h2 id="orgb945e4b"><span class="section-number-2">81</span> Beginend - go to meaningful begin/end of the buffer</h2>
<div class="outline-text-2" id="text-81">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-02-06 Sat&gt;</span></span>
</p>

<p>
Found it on a <a href="http://emacslife.com/emacs-chats/chat-magnar-sveen.html">Emacs Chat notes</a> between Sacha Chua and Magnar Sveen,
the creator of the <a href="http://emacsrocks.com">Emacs Rocks</a> screencast series.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package beginend
  :ensure t
  :demand t
  :diminish beginend-global-mode
  :config
  (beginend-global-mode))
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Pavel Popov</p>
<p class="date">Created: 2021-02-06 Sat 22:03</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
